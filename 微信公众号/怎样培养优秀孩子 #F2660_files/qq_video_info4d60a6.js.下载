define("pages/loadscript.js",[],function(){
"use strict";
function e(t){
e.counter||(e.counter=1);
var n="number"!=typeof t.retry?1:t.retry,o=t.win||window,r=o.document,a=r.createElement("script"),i=t.type||"JSONP",d=r.head||r.getElementsByTagName("head")[0]||r.documentElement,l=t.callbackName,c="uninitialized",u="undefined"==typeof t.successCode?200:t.successCode,s="undefined"==typeof t.timeoutCode?500:t.timeoutCode,f="undefined"==typeof t.scriptErrorCode?400:t.scriptErrorCode,m=!1,p=null;
"JSONP"!=i&&"JS"!=i&&(i="JSONP");
var y="";
y="JSONP"==i?t.url+"&t="+Math.random():t.url;
var h=function(e){
a&&!m&&(m=!0,p&&(clearTimeout(p),p=null),a.onload=a.onreadystatechange=a.onerror=null,
d&&a.parentNode&&d.removeChild(a),a=null,l&&-1==l.indexOf(".")&&(window[l]=null),
"JS"==i&&e==u&&"loaded"==c&&"function"==typeof t.callback?t.callback():e!=u&&"loaded"!=c&&"function"==typeof t.onerror&&t.onerror(e));
};
if(l&&"function"==typeof t.callback&&"JSONP"==i){
var w=l;
-1==l.indexOf(".")&&(l=window[l]?l+e.counter++:l,window[l]=function(){
c="loaded",t.callback.apply(null,arguments);
}),y=y.replace("="+w,"="+l);
}
a.onload=a.onreadystatechange=function(){
var e=navigator.userAgent.toLowerCase();
(-1!=e.indexOf("opera")||-1==e.indexOf("msie")||/loaded|complete/i.test(this.readyState))&&("JS"==i&&(c="loaded"),
h("loaded"==c?u:f));
},a.onerror=function(){
return n>0?(t.retry=n-1,p&&(clearTimeout(p),p=null),void e(t)):void h(f);
},t.timeout&&(p=setTimeout(function(){
h(s);
},parseInt(t.timeout,10))),c="loading",a.charset="utf-8",setTimeout(function(){
a.src=y;
try{
d.insertBefore(a,d.lastChild);
}catch(e){}
},0);
}
return e;
});define("biz_wap/utils/ajax.js",["biz_common/utils/string/html.js","biz_common/utils/url/parse.js","biz_common/utils/respTypes.js","biz_wap/utils/ajax_wx.js"],function(require,exports,module,alert){
"use strict";
function reqType(e,t){
return e.url.indexOf(t)>-1&&-1===e.url.indexOf("action=")&&(!e.data||!e.data.action);
}
function logClientLog(e){
try{
var t;
/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?t="writeLog":/(Android)/i.test(navigator.userAgent)&&(t="log"),
t&&doLog(t,e);
}catch(r){
throw console.error(r),r;
}
}
function doLog(e,t){
var r,o,a={};
r=top!=window?top.window:window;
try{
o=r.WeixinJSBridge,a=r.document;
}catch(n){}
e&&o&&o.invoke?o.invoke(e,{
level:"info",
msg:"[WechatFe][ajax]"+t
}):setTimeout(function(){
a.addEventListener?a.addEventListener("WeixinJSBridgeReady",function(){
doLog(e,t);
},!1):a.attachEvent&&(a.attachEvent("WeixinJSBridgeReady",function(){
doLog(e,t);
}),a.attachEvent("onWeixinJSBridgeReady",function(){
doLog(e,t);
}));
},0);
}
function reportRt(e,t,r){
var o="";
if(r&&r.length){
var a=1e3,n=r.length,s=Math.ceil(n/a);
o=["&lc="+s];
for(var i=0;s>i;++i)o.push("&log"+i+"=[rtCheckError]["+i+"]"+encodeURIComponent(r.substr(i*a,a)));
o=o.join("");
}
var p,c="idkey="+e+"_"+t+"_1"+o+"&r="+Math.random();
if(window.ActiveXObject)try{
p=new ActiveXObject("Msxml2.XMLHTTP");
}catch(d){
try{
p=new ActiveXObject("Microsoft.XMLHTTP");
}catch(u){
p=!1;
}
}else window.XMLHttpRequest&&(p=new XMLHttpRequest);
p&&(p.open("POST",location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?",!0),p.setRequestHeader("cache-control","no-cache"),
p.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),
p.setRequestHeader("X-Requested-With","XMLHttpRequest"),p.send(c));
}
function reportAjaxLength(e,t,r){
var o="";
if(r&&r.length){
var a=1e3,n=r.length,s=Math.ceil(n/a);
o=["&lc="+s];
for(var i=0;s>i;++i)o.push("&log"+i+"=[Ajax Length Limit]["+i+"]"+encodeURIComponent(r.substr(i*a,a)));
o=o.join("");
}
var p,c="idkey="+e+"_"+t+"_1"+o+"&r="+Math.random();
if(window.ActiveXObject)try{
p=new ActiveXObject("Msxml2.XMLHTTP");
}catch(d){
try{
p=new ActiveXObject("Microsoft.XMLHTTP");
}catch(u){
p=!1;
}
}else window.XMLHttpRequest&&(p=new XMLHttpRequest);
p&&(p.open("POST",location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?",!0),p.setRequestHeader("cache-control","no-cache"),
p.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),
p.setRequestHeader("X-Requested-With","XMLHttpRequest"),p.send(c),(new Image).src="/mp/jsmonitor?idkey="+e+"_"+t+"_1"+o+"&r="+Math.random());
}
function Ajax(obj){
var type=(obj.type||"GET").toUpperCase(),url;
url=obj.notJoinUrl?obj.url:ajaxWx.joinUrl(obj.url),"html"==obj.f&&(url=url.replace("&f=json",""));
var mayAbort=!!obj.mayAbort,async="undefined"==typeof obj.async?!0:obj.async,xhr=new XMLHttpRequest,timer=null,data=null;
if("object"==typeof obj.data){
var d=obj.data;
data=[];
for(var k in d)d.hasOwnProperty(k)&&data.push(k+"="+encodeURIComponent(d[k]));
data=data.join("&");
}else data="string"==typeof obj.data?obj.data:null;
xhr.open(type,url,async);
var _onreadystatechange=xhr.onreadystatechange;
try{
url&&url.length>LENGTH_LIMIT&&reportAjaxLength(27613,17,"ajax get limit[length: "+url.length+"]"+url.substring(0,1024));
}catch(e){}
xhr.onreadystatechange=function(){
if("function"==typeof _onreadystatechange&&_onreadystatechange.apply(xhr),3==xhr.readyState&&obj.received&&obj.received(xhr),
4==xhr.readyState){
reqType(obj,"/mp/getappmsgext")&&(window.receiveGetAppmsgExt=xhr.status+"|"+Date.now(),
logClientLog("receive appmsgext response, status: "+xhr.status)),reqType(obj,"/mp/getappmsgad")&&(window.receiveGetAppmsgAd=xhr.status+"|"+Date.now(),
logClientLog("receive appmsgad response, status: "+xhr.status)),xhr.onreadystatechange=null;
var status=xhr.status;
if(status>=200&&400>status)try{
var responseText=xhr.responseText,resp=responseText;
if("json"==obj.dataType)try{
resp=eval("("+resp+")");
var rtId=obj.rtId,rtKey=obj.rtKey||0,rtDesc=obj.rtDesc,checkRet=!0;
if(rtId&&rtDesc&&RespTypes&&!RespTypes.check(resp,rtDesc)&&reportRt(rtId,rtKey,RespTypes.getMsg()+"[detail]"+responseText+";"+obj.url),
resp&&resp.base_resp&&1*resp.base_resp.ret!==0&&"undefined"!=typeof window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&Math.random()<.001){
var reportUrl=url;
-1!==url.indexOf("?")&&(reportUrl=url.substr(0,url.indexOf("?")),Url.getQuery("action",url)&&(reportUrl=reportUrl+"?action="+Url.getQuery("action",url))),
("/mp/getappmsgext"!==reportUrl&&"/mp/getappmsgad"!==reportUrl||"undefined"!=typeof resp.base_resp.ret)&&window.WX_BJ_REPORT.BadJs.report(reportUrl,"ret="+resp.base_resp.ret,{
mid:window.PAGE_MID,
view:"wap_retcode"
});
}
}catch(e){
return void(obj.error&&obj.error(xhr,{
type:1,
error:e
}));
}
obj.success&&obj.success(resp);
}catch(e){
throw __moon_report({
offset:MOON_AJAX_SUCCESS_OFFSET,
e:e
}),e;
}else{
try{
obj.error&&obj.error(xhr,{
type:2,
error:"status error",
status:status
});
}catch(e){
throw __moon_report({
offset:MOON_AJAX_ERROR_OFFSET,
e:e
}),e;
}
if(status||!mayAbort){
var __ajaxtest=window.__ajaxtest||"0";
__moon_report({
offset:MOON_AJAX_NETWORK_OFFSET,
log:"ajax_network_error["+status+"]["+__ajaxtest+"]: "+url+";host:"+location.host,
e:""
});
}
}
clearTimeout(timer);
try{
obj.complete&&obj.complete();
}catch(e){
throw __moon_report({
offset:MOON_AJAX_COMPLETE_OFFSET,
e:e
}),e;
}
obj.complete=null;
}
},"POST"==type&&xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),
obj.noXRequestedWidthHeader||xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),
"undefined"!=typeof obj.timeout&&(timer=setTimeout(function(){
xhr.abort("timeout");
try{
obj.complete&&obj.complete();
}catch(e){
throw __moon_report({
offset:MOON_AJAX_COMPLETE_OFFSET,
e:e
}),e;
}
obj.complete=null,__moon_report({
offset:MOON_AJAX_TIMEOUT_OFFSET,
log:"ajax_timeout_error: "+url,
e:""
});
},obj.timeout));
try{
xhr.send(data);
try{
data&&data.length>LENGTH_LIMIT&&reportAjaxLength(27613,18,"ajax post limit[length: "+data.length+"]"+data.substring(0,1024));
}catch(e){}
}catch(e){
obj.error&&obj.error(xhr,{
type:3,
error:e
});
}
return reqType(obj,"/mp/getappmsgext")&&(window.startGetAppmsgExtTime=Date.now(),
logClientLog("start get appmsgext, url: ",obj.url)),reqType(obj,"/mp/getappmsgad")&&(window.startGetAppmsgAdTime=Date.now(),
logClientLog("start get appmsgad, url: ",obj.url)),xhr;
}
require("biz_common/utils/string/html.js");
var Url=require("biz_common/utils/url/parse.js"),RespTypes=require("biz_common/utils/respTypes.js"),ajaxWx=require("biz_wap/utils/ajax_wx.js"),isx5=-1!=navigator.userAgent.indexOf("TBS/"),__moon_report=window.__moon_report||function(){},MOON_AJAX_SUCCESS_OFFSET=3,MOON_AJAX_NETWORK_OFFSET=4,MOON_AJAX_ERROR_OFFSET=5,MOON_AJAX_TIMEOUT_OFFSET=6,MOON_AJAX_COMPLETE_OFFSET=7,MOON_AJAX_GET_LIMIT_4K=17,MOON_AJAX_POST_LIMIT_4K=18,LENGTH_LIMIT=4096,doc={},isAcrossOrigin=!1;
try{
doc=top.window.document;
}catch(e){
isAcrossOrigin=!0;
}
return window.__second_open__||!isAcrossOrigin&&top.window.__second_open__?ajaxWx.ajax:Ajax;
});define("biz_common/utils/url/parse.js",[],function(){
"use strict";
function r(r){
var e=r.length,n=r.indexOf("?"),t=r.indexOf("#");
t=-1==t?e:t,n=-1==n?t:n;
var a=r.substr(0,n),i=r.substr(n+1,t-n-1),s=r.substr(t+1);
return{
host:a,
query_str:i,
hash:s
};
}
function e(e,n,t){
var a=r(e),i=a.query_str,s=[];
for(var o in n)n.hasOwnProperty(o)&&s.push(o+"="+(t?n[o]:encodeURIComponent(n[o])));
return s.length>0&&(i+=(""!=i?"&":"")+s.join("&")),a.host+(""!=i?"?"+i:"")+(""!=a.hash?"#"+a.hash:"");
}
function n(r,e,n,t){
r=r||location.href;
var a=r.indexOf("&"),i=r.length,s=r.replace(/^[\w\d]+:[\/\\]+/g,"").split("").reverse();
Array.prototype.indexOf||(Array.prototype.indexOf=function(r,e){
var n;
if(null==this)throw new TypeError('"this" is null or not defined');
var t=Object(this),a=t.length>>>0;
if(0===a)return-1;
var i=+e||0;
if(1/0===Math.abs(i)&&(i=0),i>=a)return-1;
for(n=Math.max(i>=0?i:a-Math.abs(i),0);a>n;){
if(n in t&&t[n]===r)return n;
n++;
}
return-1;
});
var o=i-1-s.indexOf("/");
-1!=a&&-1==r.indexOf("?")&&a>o&&(r=r.replace("&","?"));
var u=new RegExp("([\\?&]"+e+"=)[^&#]*");
if(!r.match(u)){
var h=r.indexOf("?");
return-1==h?r+"?"+e+"="+n:h==r.length-1?r+e+"="+n:r+"&"+e+"="+n;
}
return t===!0?r.replace(u,"$1"+n):r;
}
function t(r){
var e=arguments[1]||window.location.search,n=new RegExp("(^|&)"+r+"=([^&]*)(&|$)"),t=e.substr(e.indexOf("?")+1).match(n);
return null!=t?t[2]:"";
}
return{
parseUrl:r,
join:e,
addParam:n,
getQuery:t
};
});define("biz_wap/utils/mmversion.js",[],function(){
"use strict";
function n(){
var n=/MicroMessenger\/([\d\.]+)/i,i=o.match(n);
return i&&i[1]?i[1]:!1;
}
function i(i,t,r){
var e=n();
if(e){
e=e.split("."),i=i.split("."),/\d+/g.test(e[e.length-1])||e.pop();
for(var s,o,u=m["cp"+t],a=0,c=Math.max(e.length,i.length);c>a;++a){
s=e[a]||0,o=i[a]||0,s=parseInt(s)||0,o=parseInt(o)||0;
var d=m.cp0(s,o);
if(!d)return u(s,o);
}
return r||0==t?!0:!1;
}
}
function t(n){
return i(n,0);
}
function r(n,t){
return i(n,1,t);
}
function e(n,t){
return i(n,-1,t);
}
function s(){
return u?"ios":c?"android":p?"mac_os":f?"windows":"unknown";
}
var o=navigator.userAgent,u=/(iPhone|iPad|iPod|iOS)/i.test(o),a=/Windows\sPhone/i.test(o),c=/(Android)/i.test(o),d=/MicroMessenger\/([\d\.]+)/i.test(o),p=/mac\sos/i.test(o),f=/windows\snt/i.test(o)&&!a,g=c&&/miniprogram/.test(o.toLowerCase())||"miniprogram"==window.__wxjs_environment,m={
"cp-1":function(n,i){
return i>n;
},
cp0:function(n,i){
return n==i;
},
cp1:function(n,i){
return n>i;
}
};
return{
get:n,
cpVersion:i,
eqVersion:t,
gtVersion:r,
ltVersion:e,
getPlatform:s,
isWp:a,
isIOS:u,
isAndroid:c,
isInMiniProgram:g,
isWechat:d,
isMac:p,
isWindows:f
};
});function _typeof(e){
return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e;
}
define("a/a_utils.js",["biz_wap/jsapi/core.js","biz_wap/utils/ajax.js","biz_wap/utils/mmversion.js","biz_common/utils/report.js","biz_common/dom/class.js","biz_common/utils/url/parse.js","biz_wap/utils/openUrl.js","biz_wap/utils/wapsdk.js","common/utils.js"],function(e){
"use strict";
function t(e,t){
f("/mp/ad_report?action=follow&type="+e+t);
}
function n(e,t){
y.jsmonitor({
id:115849,
key:e,
value:t
});
}
function r(e){
y.jsmonitor({
id:28307,
key:e
});
}
function i(e){
if(!e)return"";
var t=document.createElement("a");
return t.href=e,t.hostname;
}
function o(e){
for(var t=[],n=0;n<e.length;++n){
var r=e[n],i="undefined"==typeof r?"undefined":_typeof(r);
r="string"===i?r.htmlDecode():r,"object"===i&&(r="[object Array]"===Object.prototype.toString.call(r)?o(r):a(r)),
t.push(r);
}
return t;
}
function a(e){
var t={};
for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){
var r=e[n],i="undefined"==typeof r?"undefined":_typeof(r);
r="string"===i?r.htmlDecode():r,"object"===i&&(r="[object Array]"===Object.prototype.toString.call(r)?o(r):a(r)),
t[n]=r;
}
return t;
}
function s(e,t){
var n=0;
l.isIOS?n=1:l.isAndroid&&(n=2);
var r={
creative_load_fail:[{
ts:parseInt(+new Date/1e3,10),
aid:parseInt(e.info.aid,10),
img_url:encodeURIComponent(t),
network_type:window.networkType,
errmsg:"",
os_type:n,
client_version:parseInt(window.clientversion,10),
traceid:e.info.traceid
}]
};
r=JSON.stringify(r),m({
url:"/mp/advertisement_report?action=extra_report&extra_data="+r+"&__biz="+window.biz,
timeout:2e3
});
}
function p(e,t){
var n={
ad_sign_data:t.adSignData,
ad_sign_k1:t.adSignK1,
ad_sign_k2:t.adSignK2,
ad_sign_md5:t.signMd5
};
return g.join(e,n,!0);
}
function d(e,t,n,r){
try{
e.postMessage(JSON.stringify({
action:t,
value:n
}),r||"*");
}catch(i){
console.log("postMessage error",i);
}
}
function c(e,t){
if(!e||!e.flow_exp_info)return"";
var n=e.flow_exp_info||"";
try{
n=JSON.parse(n.replace(/&quot;/g,'"'));
}catch(r){
return"";
}
if(!n.length)return"";
for(var i=0;i<n.length;i++)if(n[i].exp_para&&n[i].exp_para.length)for(var o=0;o<n[i].exp_para.length;o++)if(n[i].exp_para[o].name===t)return n[i].exp_para[o].value;
return null;
}
var u=e("biz_wap/jsapi/core.js"),m=e("biz_wap/utils/ajax.js"),l=e("biz_wap/utils/mmversion.js"),f=e("biz_common/utils/report.js"),_=e("biz_common/dom/class.js"),g=e("biz_common/utils/url/parse.js"),w=e("biz_wap/utils/openUrl.js").openUrlWithExtraWebview,y=e("biz_wap/utils/wapsdk.js"),v=e("common/utils.js"),b="pos_",h=[" ","-","(",":",'"',"'","：","（","—","－","“","‘"],j=["wximg.qq.com","wximg.gtimg.com","pgdt.gtimg.cn","mmsns.qpic.cn","mmbiz.qpic.cn","vweixinthumb.tc.qq.com","pp.myapp.com","wx.qlog.cn","mp.weixin.qq.com"],x=[350064395,3194181833,3191183081,3191008240,459315e3,2547206501,17516575,3194183798,3193008987,3191008237,3190008366,1314021127,3190008373,3192140177,3193183025,3191138746,3192008231,3191138747,3191138743,3193183023,3193183029,3192138635,3190138969,3192138631,3194182870,3192138630,3194182869,3192138629,3192138628,3193183024,3191138744,3192138627,3194182868,3193183031,3192138634,3190138972,3191138745,3192138633,3193183030,3190138971,3193183028,3193183027,3193183026,3190138970,3192138632,3192184240,3194248804,388382775,3193008989,3193008986,3194241008,3193240873,3193240874,3190179574],z={
report:t,
report115849:n,
saveCopy:a,
joinSignParam:p,
postMessage:d,
getExpParaVal:c,
checkShowCpc:function(e,t,n,r){
if(t)return!0;
if(!e)return!1;
var i=v.getInnerHeight(),o=i/2,a=e.offsetTop,s=n.offsetHeight,p=void 0;
if(o>a?p=1:i>a&&(p=2),p&&r){
var d=JSON.stringify({
biz_middle_not_exp:[{
scene:p,
traceid:r.traceid,
aid:+r.aid,
appmsg_id:+window.appmsgid,
item_idx:+window.idx
}]
});
m({
url:"/mp/advertisement_report?action=extra_report&extra_data="+d+"&__biz="+window.biz,
timeout:2e3
});
}
return o>a||o>s-a?!1:!0;
},
openWebAppStore:function(e,t){
return v.getIosMainVersion()>=12?void u.invoke("launchApplication",{
schemeUrl:e
},function(){}):void u.invoke("downloadAppInternal",{
appUrl:e
},function(n){
n.err_msg&&-1!==n.err_msg.indexOf("ok")||w("/mp/ad_redirect?url="+encodeURIComponent(e)+"&ticket="+t);
});
},
adOptReport:function(e,t,n,r){
var i=g.join("/mp/ad_complaint",{
action:"report",
type:e,
pos_type:t,
trace_id:n,
aid:r,
__biz:window.biz,
r:Math.random()
},!0);
f(i);
},
checkAdImg:function(e){
if(e){
var t=e.image_url||"",n=i(t);
n&&-1===j.indexOf(n)&&r(58);
}
},
formName:function(e){
for(var t=-1,n=0,r=h.length;r>n;++n){
var i=h[n],o=e.indexOf(i);
-1!==o&&(-1===t||t>o)&&(t=o);
}
return-1!==t&&(e=e.substring(0,t)),e;
},
formSize:function(e){
return"number"!=typeof e?e:(e>=1024?(e/=1024,e=e>=1024?(e/1024).toFixed(2)+"MB":e.toFixed(2)+"KB"):e=e.toFixed(2)+"B",
e);
},
debounce:function(e,t,n){
var r=void 0;
return function(){
var i=this,o=arguments,a=function(){
r=null,n||e.apply(i,o);
},s=n&&!r;
r||(r=setTimeout(a,t),s&&e.apply(i,o));
};
},
isItunesLink:function(e){
return/^https?:\/\/(itunes|apps)\.apple\.com\//.test(e);
},
extend:function(e,t){
for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);
return e;
},
getPosKeyDesc:function(e,t){
var n=t?e+"_"+t:e;
return b+n;
},
openCanvasAd:function(e){
u.invoke("openADCanvas",{
canvasId:e.canvasId,
preLoad:0,
noStore:0,
extraData:JSON.stringify({
pos_type:e.pos_type
}),
adInfoXml:e.adInfoXml
},function(n){
0!==Number(n.ret)?(w(e.url),t(135,e.report_param)):t(134,e.report_param);
});
},
setBackgroundClass:function(){
window._has_comment||0!==window.adDatas.realNum||window._share_redirect_url||window.is_temp_url?_.removeClass(document.body,"rich_media_empty_extra"):_.addClass(document.body,"rich_media_empty_extra");
},
lazyLoadAdImg:function(e){
for(var t=document.getElementsByClassName("js_alazy_img"),n=function(n){
var i=t[n];
i.onload=function(){
r(54),i.src.indexOf("retry")>-1&&r(69);
},i.onerror=function(){
-1===i.src.indexOf("retry")?i.src=g.addParam(i.src,"retry",1):!function(){
r(98);
var t="other";
l.isIOS?t="iphone":l.isAndroid&&(t="android"),setTimeout(function(){
var n=window.networkType||"unknow",r=g.join("/tp/datacenter/report",{
cmd:"report",
id:900023,
uin:777,
os:t,
aid:e.aid,
image_url:encodeURIComponent(i.src),
type:e.type,
network:n
},!0);
m({
url:r,
async:!0
});
},500),s(e,i.src);
}(),r(57);
},i.src=i.dataset.src;
},i=0;i<t.length;i++)n(i);
},
reportUrlLength:function(e,t,r,i,o,a,s){
var d=p(s,{
adSignData:e,
adSignK1:t,
adSignK2:r,
signMd5:i,
viewidKeyObj:o
});
if(d.length>=4e3){
n(13);
var c=JSON.stringify({
biz_log_report:[{
pos_type:+a.pos_type,
traceid:a.tid,
aid:+a.aid,
log_type:1,
ext_info:"[url length:"+d.length+"]"+s.substring(0,2e3)
}]
});
m({
url:"/mp/advertisement_report?action=extra_report",
timeout:2e3,
data:{
extra_data:c,
__biz:window.biz
},
type:"post"
});
}
},
isVideoSharePageOnlyAd:function(){
return"5"===window.item_show_type&&"ad"===g.getQuery("render_type");
},
listenMessage:function(e,t,n){
arguments.length<3&&(n=t,t=null),e.addEventListener("message",function(e){
var r=void 0;
if(!t||e.origin===t){
if("object"!==_typeof(e.data))try{
r=JSON.parse(e.data);
}catch(i){
return;
}else r=e.data;
"function"==typeof n&&n(e,r);
}
});
},
isSample:function(e){
return x.indexOf(window.user_uin)>-1?!0:window.user_uin&&window.user_uin/100%1e3<=10*e?!0:!1;
},
broadcastFrame:function(e,t,n,r){
e=e||[];
for(var i=0;i<e.length;i++){
var o=e[i].src||e[i].getAttribute("data-realsrc");
(!r||r&&o.indexOf(r)>-1)&&d(e[i].contentWindow,t,n);
}
}
};
return z;
});define("biz_wap/zepto/touch.js",["biz_wap/zepto/zepto.js"],function(e){
"use strict";
e("biz_wap/zepto/zepto.js"),function(e){
function t(e,t,o,n){
return Math.abs(e-t)>=Math.abs(o-n)?e-t>0?"Left":"Right":o-n>0?"Up":"Down";
}
function o(){
p=null,g.last&&(g.el&&"function"==typeof g.el.trigger&&g.el.trigger("longTap"),g={});
}
function n(){
p&&clearTimeout(p),p=null;
}
function i(){
a&&clearTimeout(a),l&&clearTimeout(l),c&&clearTimeout(c),p&&clearTimeout(p),a=l=c=p=null,
g={};
}
function r(e){
return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary;
}
function u(e,t){
return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t;
}
var a,l,c,p,s,g={},f=750;
e(document).ready(function(){
var w,y,T,h,d=0,m=0;
"MSGesture"in window&&(s=new MSGesture,s.target=document.body),e(document).bind("MSGestureEnd",function(e){
var t=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;
t&&g.el&&"function"==typeof g.el.trigger&&(g.el.trigger("swipe"),g.el.trigger("swipe"+t));
}).on("touchstart MSPointerDown pointerdown",function(t){
(!(h=u(t,"down"))||r(t))&&(T=h?t:t.touches[0],t.touches&&1===t.touches.length&&g.x2&&(g.x2=void 0,
g.y2=void 0),w=Date.now(),y=w-(g.last||w),g.el=e("tagName"in T.target?T.target:T.target.parentNode),
a&&clearTimeout(a),g.x1=T.pageX,g.y1=T.pageY,y>0&&250>=y&&(g.isDoubleTap=!0),g.last=w,
p=setTimeout(o,f),s&&h&&s.addPointer(t.pointerId));
}).on("touchmove MSPointerMove pointermove",function(e){
(!(h=u(e,"move"))||r(e))&&(T=h?e:e.touches[0],n(),g.x2=T.pageX,g.y2=T.pageY,d+=Math.abs(g.x1-g.x2),
m+=Math.abs(g.y1-g.y2));
}).on("touchend MSPointerUp pointerup",function(o){
(!(h=u(o,"up"))||r(o))&&(n(),g.x2&&Math.abs(g.x1-g.x2)>30||g.y2&&Math.abs(g.y1-g.y2)>30?c=setTimeout(function(){
g.el&&"function"==typeof g.el.trigger&&(g.el.trigger("swipe"),g.el.trigger("swipe"+t(g.x1,g.x2,g.y1,g.y2))),
g={};
},0):"last"in g&&(30>d&&30>m?l=setTimeout(function(){
var t=e.Event("tap");
t.cancelTouch=i,g.el&&"function"==typeof g.el.trigger&&g.el.trigger(t),g.isDoubleTap?(g.el&&g.el.trigger("doubleTap"),
g={}):a=setTimeout(function(){
a=null,g.el&&g.el.trigger("singleTap"),g={};
},250);
},0):g={}),d=m=0);
}).on("touchcancel MSPointerCancel pointercancel",i),e(window).on("scroll",i);
}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){
e.fn[t]=function(e){
return this.on(t,e);
};
});
}(Zepto);
});define("biz_wap/zepto/event.js",["biz_wap/zepto/zepto.js"],function(e){
"use strict";
e("biz_wap/zepto/zepto.js"),function(e){
function n(e){
return e._zid||(e._zid=d++);
}
function t(e,t,o,u){
if(t=r(t),t.ns)var a=i(t.ns);
return(g[n(e)]||[]).filter(function(e){
return!(!e||t.e&&e.e!=t.e||t.ns&&!a.test(e.ns)||o&&n(e.fn)!==n(o)||u&&e.sel!=u);
});
}
function r(e){
var n=(""+e).split(".");
return{
e:n[0],
ns:n.slice(1).sort().join(" ")
};
}
function i(e){
return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)");
}
function o(e,n){
return e.del&&!y&&e.e in E||!!n;
}
function u(e){
return b[e]||y&&E[e]||e;
}
function a(t,i,a,s,f,d,l){
var v=n(t),h=g[v]||(g[v]=[]);
i.split(/\s/).forEach(function(n){
if("ready"==n)return e(document).ready(a);
var i=r(n);
i.fn=a,i.sel=f,i.e in b&&(a=function(n){
var t=n.relatedTarget;
return!t||t!==this&&!e.contains(this,t)?i.fn.apply(this,arguments):void 0;
}),i.del=d;
var v=d||a;
i.proxy=function(e){
if(e=c(e),!e.isImmediatePropagationStopped()){
e.customData=s;
var n=v.apply(t,e._args==p?[e]:[e].concat(e._args));
return n===!1&&(e.preventDefault(),e.stopPropagation()),n;
}
},i.i=h.length,h.push(i),"addEventListener"in t&&t.addEventListener(u(i.e),i.proxy,o(i,l));
});
}
function s(e,r,i,a,s){
var c=n(e);
(r||"").split(/\s/).forEach(function(n){
t(e,n,i,a).forEach(function(n){
delete g[c][n.i],"removeEventListener"in e&&e.removeEventListener(u(n.e),n.proxy,o(n,s));
});
});
}
function c(n,t){
return(t||!n.isDefaultPrevented)&&(t||(t=n),e.each(_,function(e,r){
var i=t[e];
n[e]=function(){
return this[r]=P,i&&i.apply(t,arguments);
},n[r]=z;
}),(t.defaultPrevented!==p?t.defaultPrevented:"returnValue"in t?t.returnValue===!1:t.getPreventDefault&&t.getPreventDefault())&&(n.isDefaultPrevented=P)),
n;
}
function f(e){
var n,t={
originalEvent:e
};
for(n in e)w.test(n)||e[n]===p||(t[n]=e[n]);
return c(t,e);
}
var p,d=(e.zepto.qsa,1),l=Array.prototype.slice,v=e.isFunction,h=function(e){
return"string"==typeof e;
},g={},m={},y="onfocusin"in window,E={
focus:"focusin",
blur:"focusout"
},b={
mouseenter:"mouseover",
mouseleave:"mouseout"
};
m.click=m.mousedown=m.mouseup=m.mousemove="MouseEvents",e.event={
add:a,
remove:s
},e.proxy=function(t,r){
if(v(t)){
var i=function(){
return t.apply(r,arguments);
};
return i._zid=n(t),i;
}
if(h(r))return e.proxy(t[r],t);
throw new TypeError("expected function");
},e.fn.bind=function(e,n,t){
return this.on(e,n,t);
},e.fn.unbind=function(e,n){
return this.off(e,n);
},e.fn.one=function(e,n,t,r){
return this.on(e,n,t,r,1);
};
var P=function(){
return!0;
},z=function(){
return!1;
},w=/^([A-Z]|returnValue$|layer[XY]$)/,_={
preventDefault:"isDefaultPrevented",
stopImmediatePropagation:"isImmediatePropagationStopped",
stopPropagation:"isPropagationStopped"
};
e.fn.delegate=function(e,n,t){
return this.on(n,e,t);
},e.fn.undelegate=function(e,n,t){
return this.off(n,e,t);
},e.fn.live=function(n,t){
return e(document.body).delegate(this.selector,n,t),this;
},e.fn.die=function(n,t){
return e(document.body).undelegate(this.selector,n,t),this;
},e.fn.on=function(n,t,r,i,o){
var u,c,d=this;
return n&&!h(n)?(e.each(n,function(e,n){
d.on(e,t,r,n,o);
}),d):(h(t)||v(i)||i===!1||(i=r,r=t,t=p),(v(r)||r===!1)&&(i=r,r=p),i===!1&&(i=z),
d.each(function(p,d){
o&&(u=function(e){
return s(d,e.type,i),i.apply(this,arguments);
}),t&&(c=function(n){
var r,o=e(n.target).closest(t,d).get(0);
return o&&o!==d?(r=e.extend(f(n),{
currentTarget:o,
liveFired:d
}),(u||i).apply(o,[r].concat(l.call(arguments,1)))):void 0;
}),a(d,n,i,r,t,c||u);
}));
},e.fn.off=function(n,t,r){
var i=this;
return n&&!h(n)?(e.each(n,function(e,n){
i.off(e,t,n);
}),i):(h(t)||v(r)||r===!1||(r=t,t=p),r===!1&&(r=z),i.each(function(){
s(this,n,r,t);
}));
},e.fn.trigger=function(n,t){
return n=h(n)||e.isPlainObject(n)?e.Event(n):c(n),n._args=t,this.each(function(){
"dispatchEvent"in this?this.dispatchEvent(n):e(this).triggerHandler(n,t);
});
},e.fn.triggerHandler=function(n,r){
var i,o;
return this.each(function(u,a){
i=f(h(n)?e.Event(n):n),i._args=r,i.target=a,e.each(t(a,n.type||n),function(e,n){
return o=n.proxy(i),i.isImmediatePropagationStopped()?!1:void 0;
});
}),o;
},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(n){
e.fn[n]=function(e){
return e?this.bind(n,e):this.trigger(n);
};
}),["focus","blur"].forEach(function(n){
e.fn[n]=function(e){
return e?this.bind(n,e):this.each(function(){
try{
this[n]();
}catch(e){}
}),this;
};
}),e.Event=function(e,n){
h(e)||(n=e,e=n.type);
var t=document.createEvent(m[e]||"Events"),r=!0;
if(n)for(var i in n)"bubbles"==i?r=!!n[i]:t[i]=n[i];
return t.initEvent(e,r,!0),c(t);
};
}(Zepto);
});define("biz_wap/zepto/zepto.js",[],function(){
"use strict";
var t=function(){
function t(t){
return null==t?String(t):J[W.call(t)]||"object";
}
function n(n){
return"function"==t(n);
}
function e(t){
return null!=t&&t==t.window;
}
function i(t){
return null!=t&&t.nodeType==t.DOCUMENT_NODE;
}
function r(n){
return"object"==t(n);
}
function o(t){
return r(t)&&!e(t)&&Object.getPrototypeOf(t)==Object.prototype;
}
function s(t){
return t instanceof Array;
}
function u(t){
return"number"==typeof t.length;
}
function c(t){
return P.call(t,function(t){
return null!=t;
});
}
function a(t){
return t.length>0?C.fn.concat.apply([],t):t;
}
function l(t){
return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase();
}
function f(t){
return t in M?M[t]:M[t]=new RegExp("(^|\\s)"+t+"(\\s|$)");
}
function h(t,n){
return"number"!=typeof n||z[l(t)]?n:n+"px";
}
function p(t){
var n,e;
return j[t]||(n=L.createElement(t),L.body.appendChild(n),e=getComputedStyle(n,"").getPropertyValue("display"),
n.parentNode.removeChild(n),"none"==e&&(e="block"),j[t]=e),j[t];
}
function d(t){
return"children"in t?$.call(t.children):C.map(t.childNodes,function(t){
return 1==t.nodeType?t:void 0;
});
}
function g(t,n,e){
for(E in n)e&&(o(n[E])||s(n[E]))?(o(n[E])&&!o(t[E])&&(t[E]={}),s(n[E])&&!s(t[E])&&(t[E]=[]),
g(t[E],n[E],e)):n[E]!==x&&(t[E]=n[E]);
}
function m(t,n){
return null==n?C(t):C(t).filter(n);
}
function v(t,e,i,r){
return n(e)?e.call(t,i,r):e;
}
function y(t,n,e){
null==e?t.removeAttribute(n):t.setAttribute(n,e);
}
function b(t,n){
var e=t.className,i=e&&e.baseVal!==x;
return n===x?i?e.baseVal:e:void(i?e.baseVal=n:t.className=n);
}
function w(t){
var n;
try{
return t?"true"==t||("false"==t?!1:"null"==t?null:/^0/.test(t)||isNaN(n=Number(t))?/^[\[\{]/.test(t)?C.parseJSON(t):t:n):t;
}catch(e){
return t;
}
}
function N(t,n){
n(t);
for(var e in t.childNodes)N(t.childNodes[e],n);
}
var x,E,C,O,T,S,A=[],$=A.slice,P=A.filter,L=window.document,j={},M={},z={
"column-count":1,
columns:1,
"font-weight":1,
"line-height":1,
opacity:1,
"z-index":1,
zoom:1
},Z=/^\s*<(\w+|!)[^>]*>/,q=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,B=/^(?:body|html)$/i,R=/([A-Z])/g,V=["val","css","html","text","data","width","height","offset"],F=["after","prepend","before","append"],H=L.createElement("table"),I=L.createElement("tr"),U={
tr:L.createElement("tbody"),
tbody:H,
thead:H,
tfoot:H,
td:I,
th:I,
"*":L.createElement("div")
},_=/complete|loaded|interactive/,D=/^[\w-]*$/,J={},W=J.toString,X={},Y=L.createElement("div"),G={
tabindex:"tabIndex",
readonly:"readOnly",
"for":"htmlFor",
"class":"className",
maxlength:"maxLength",
cellspacing:"cellSpacing",
cellpadding:"cellPadding",
rowspan:"rowSpan",
colspan:"colSpan",
usemap:"useMap",
frameborder:"frameBorder",
contenteditable:"contentEditable"
};
X.matches=function(t,n){
if(!n||!t||1!==t.nodeType)return!1;
var e=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;
if(e)return e.call(t,n);
var i,r=t.parentNode,o=!r;
return o&&(r=Y).appendChild(t),i=~X.qsa(r,n).indexOf(t),o&&Y.removeChild(t),i;
},T=function(t){
return t.replace(/-+(.)?/g,function(t,n){
return n?n.toUpperCase():"";
});
},S=function(t){
return P.call(t,function(n,e){
return t.indexOf(n)==e;
});
},X.fragment=function(t,n,e){
var i,r,s;
return q.test(t)&&(i=C(L.createElement(RegExp.$1))),i||(t.replace&&(t=t.replace(k,"<$1></$2>")),
n===x&&(n=Z.test(t)&&RegExp.$1),n in U||(n="*"),s=U[n],s.innerHTML=""+t,i=C.each($.call(s.childNodes),function(){
s.removeChild(this);
})),o(e)&&(r=C(i),C.each(e,function(t,n){
V.indexOf(t)>-1?r[t](n):r.attr(t,n);
})),i;
},X.Z=function(t,n){
t=t||[];
for(var e in C.fn)t[e]=C.fn[e];
return t.selector=n||"",t;
},X.isZ=function(t){
return t instanceof X.Z;
},X.init=function(t,e){
var i;
if(!t)return X.Z();
if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&Z.test(t))i=X.fragment(t,RegExp.$1,e),
t=null;else{
if(e!==x)return C(e).find(t);
i=X.qsa(L,t);
}else{
if(n(t))return C(L).ready(t);
if(X.isZ(t))return t;
if(s(t))i=c(t);else if(r(t))i=[t],t=null;else if(Z.test(t))i=X.fragment(t.trim(),RegExp.$1,e),
t=null;else{
if(e!==x)return C(e).find(t);
i=X.qsa(L,t);
}
}
return X.Z(i,t);
},C=function(t,n){
return X.init(t,n);
},C.extend=function(t){
var n,e=$.call(arguments,1);
return"boolean"==typeof t&&(n=t,t=e.shift()),e.forEach(function(e){
g(t,e,n);
}),t;
},X.qsa=function(t,n){
var e,r="#"==n[0],o=!r&&"."==n[0],s=r||o?n.slice(1):n,u=D.test(s);
return i(t)&&u&&r?(e=t.getElementById(s))?[e]:[]:1!==t.nodeType&&9!==t.nodeType?[]:$.call(u&&!r?o?t.getElementsByClassName(s):t.getElementsByTagName(n):t.querySelectorAll(n));
},C.contains=function(t,n){
return t!==n&&t.contains(n);
},C.type=t,C.isFunction=n,C.isWindow=e,C.isArray=s,C.isPlainObject=o,C.isEmptyObject=function(t){
var n;
for(n in t)return!1;
return!0;
},C.inArray=function(t,n,e){
return A.indexOf.call(n,t,e);
},C.camelCase=T,C.trim=function(t){
return null==t?"":String.prototype.trim.call(t);
},C.uuid=0,C.support={},C.expr={},C.map=function(t,n){
var e,i,r,o=[];
if(u(t))for(i=0;i<t.length;i++)e=n(t[i],i),null!=e&&o.push(e);else for(r in t)e=n(t[r],r),
null!=e&&o.push(e);
return a(o);
},C.each=function(t,n){
var e,i;
if(u(t)){
for(e=0;e<t.length;e++)if(n.call(t[e],e,t[e])===!1)return t;
}else for(i in t)if(n.call(t[i],i,t[i])===!1)return t;
return t;
},C.grep=function(t,n){
return P.call(t,n);
},window.JSON&&(C.parseJSON=JSON.parse),C.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,n){
J["[object "+n+"]"]=n.toLowerCase();
}),C.fn={
forEach:A.forEach,
reduce:A.reduce,
push:A.push,
sort:A.sort,
indexOf:A.indexOf,
concat:A.concat,
map:function(t){
return C(C.map(this,function(n,e){
return t.call(n,e,n);
}));
},
slice:function(){
return C($.apply(this,arguments));
},
ready:function(t){
return _.test(L.readyState)&&L.body?t(C):L.addEventListener("DOMContentLoaded",function(){
t(C);
},!1),this;
},
get:function(t){
return t===x?$.call(this):this[t>=0?t:t+this.length];
},
toArray:function(){
return this.get();
},
size:function(){
return this.length;
},
remove:function(){
return this.each(function(){
null!=this.parentNode&&this.parentNode.removeChild(this);
});
},
each:function(t){
return A.every.call(this,function(n,e){
return t.call(n,e,n)!==!1;
}),this;
},
filter:function(t){
return n(t)?this.not(this.not(t)):C(P.call(this,function(n){
return X.matches(n,t);
}));
},
add:function(t,n){
return C(S(this.concat(C(t,n))));
},
is:function(t){
return this.length>0&&X.matches(this[0],t);
},
not:function(t){
var e=[];
if(n(t)&&t.call!==x)this.each(function(n){
t.call(this,n)||e.push(this);
});else{
var i="string"==typeof t?this.filter(t):u(t)&&n(t.item)?$.call(t):C(t);
this.forEach(function(t){
i.indexOf(t)<0&&e.push(t);
});
}
return C(e);
},
has:function(t){
return this.filter(function(){
return r(t)?C.contains(this,t):C(this).find(t).size();
});
},
eq:function(t){
return-1===t?this.slice(t):this.slice(t,+t+1);
},
first:function(){
var t=this[0];
return t&&!r(t)?t:C(t);
},
last:function(){
var t=this[this.length-1];
return t&&!r(t)?t:C(t);
},
find:function(t){
var n,e=this;
return n="object"==typeof t?C(t).filter(function(){
var t=this;
return A.some.call(e,function(n){
return C.contains(n,t);
});
}):1==this.length?C(X.qsa(this[0],t)):this.map(function(){
return X.qsa(this,t);
});
},
closest:function(t,n){
var e=this[0],r=!1;
for("object"==typeof t&&(r=C(t));e&&!(r?r.indexOf(e)>=0:X.matches(e,t));)e=e!==n&&!i(e)&&e.parentNode;
return C(e);
},
parents:function(t){
for(var n=[],e=this;e.length>0;)e=C.map(e,function(t){
return(t=t.parentNode)&&!i(t)&&n.indexOf(t)<0?(n.push(t),t):void 0;
});
return m(n,t);
},
parent:function(t){
return m(S(this.pluck("parentNode")),t);
},
children:function(t){
return m(this.map(function(){
return d(this);
}),t);
},
contents:function(){
return this.map(function(){
return $.call(this.childNodes);
});
},
siblings:function(t){
return m(this.map(function(t,n){
return P.call(d(n.parentNode),function(t){
return t!==n;
});
}),t);
},
empty:function(){
return this.each(function(){
this.innerHTML="";
});
},
pluck:function(t){
return C.map(this,function(n){
return n[t];
});
},
show:function(){
return this.each(function(){
"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName));
});
},
replaceWith:function(t){
return this.before(t).remove();
},
wrap:function(t){
var e=n(t);
if(this[0]&&!e)var i=C(t).get(0),r=i.parentNode||this.length>1;
return this.each(function(n){
C(this).wrapAll(e?t.call(this,n):r?i.cloneNode(!0):i);
});
},
wrapAll:function(t){
if(this[0]){
C(this[0]).before(t=C(t));
for(var n;(n=t.children()).length;)t=n.first();
C(t).append(this);
}
return this;
},
wrapInner:function(t){
var e=n(t);
return this.each(function(n){
var i=C(this),r=i.contents(),o=e?t.call(this,n):t;
r.length?r.wrapAll(o):i.append(o);
});
},
unwrap:function(){
return this.parent().each(function(){
C(this).replaceWith(C(this).children());
}),this;
},
clone:function(){
return this.map(function(){
return this.cloneNode(!0);
});
},
hide:function(){
return this.css("display","none");
},
toggle:function(t){
return this.each(function(){
var n=C(this);
(t===x?"none"==n.css("display"):t)?n.show():n.hide();
});
},
prev:function(t){
return C(this.pluck("previousElementSibling")).filter(t||"*");
},
next:function(t){
return C(this.pluck("nextElementSibling")).filter(t||"*");
},
html:function(t){
return 0===arguments.length?this.length>0?this[0].innerHTML:null:this.each(function(n){
var e=this.innerHTML;
C(this).empty().append(v(this,t,n,e));
});
},
text:function(t){
return 0===arguments.length?this.length>0?this[0].textContent:null:this.each(function(){
this.textContent=t===x?"":""+t;
});
},
attr:function(t,n){
var e;
return"string"==typeof t&&n===x?0==this.length||1!==this[0].nodeType?x:"value"==t&&"INPUT"==this[0].nodeName?this.val():!(e=this[0].getAttribute(t))&&t in this[0]?this[0][t]:e:this.each(function(e){
if(1===this.nodeType)if(r(t))for(E in t)y(this,E,t[E]);else y(this,t,v(this,n,e,this.getAttribute(t)));
});
},
removeAttr:function(t){
return this.each(function(){
1===this.nodeType&&y(this,t);
});
},
prop:function(t,n){
return t=G[t]||t,n===x?this[0]&&this[0][t]:this.each(function(e){
this[t]=v(this,n,e,this[t]);
});
},
data:function(t,n){
var e=this.attr("data-"+t.replace(R,"-$1").toLowerCase(),n);
return null!==e?w(e):x;
},
val:function(t){
return 0===arguments.length?this[0]&&(this[0].multiple?C(this[0]).find("option").filter(function(){
return this.selected;
}).pluck("value"):this[0].value):this.each(function(n){
this.value=v(this,t,n,this.value);
});
},
offset:function(t){
if(t)return this.each(function(n){
var e=C(this),i=v(this,t,n,e.offset()),r=e.offsetParent().offset(),o={
top:i.top-r.top,
left:i.left-r.left
};
"static"==e.css("position")&&(o.position="relative"),e.css(o);
});
if(0==this.length)return null;
var n=this[0].getBoundingClientRect();
return{
left:n.left+window.pageXOffset,
top:n.top+window.pageYOffset,
width:Math.round(n.width),
height:Math.round(n.height)
};
},
css:function(n,e){
if(arguments.length<2){
var i=this[0],r=getComputedStyle(i,"");
if(!i)return;
if("string"==typeof n)return i.style[T(n)]||r.getPropertyValue(n);
if(s(n)){
var o={};
return C.each(s(n)?n:[n],function(t,n){
o[n]=i.style[T(n)]||r.getPropertyValue(n);
}),o;
}
}
var u="";
if("string"==t(n))e||0===e?u=l(n)+":"+h(n,e):this.each(function(){
this.style.removeProperty(l(n));
});else for(E in n)n[E]||0===n[E]?u+=l(E)+":"+h(E,n[E])+";":this.each(function(){
this.style.removeProperty(l(E));
});
return this.each(function(){
this.style.cssText+=";"+u;
});
},
index:function(t){
return t?this.indexOf(C(t)[0]):this.parent().children().indexOf(this[0]);
},
hasClass:function(t){
return t?A.some.call(this,function(t){
return this.test(b(t));
},f(t)):!1;
},
addClass:function(t){
return t?this.each(function(n){
O=[];
var e=b(this),i=v(this,t,n,e);
i.split(/\s+/g).forEach(function(t){
C(this).hasClass(t)||O.push(t);
},this),O.length&&b(this,e+(e?" ":"")+O.join(" "));
}):this;
},
removeClass:function(t){
return this.each(function(n){
return t===x?b(this,""):(O=b(this),v(this,t,n,O).split(/\s+/g).forEach(function(t){
O=O.replace(f(t)," ");
}),void b(this,O.trim()));
});
},
toggleClass:function(t,n){
return t?this.each(function(e){
var i=C(this),r=v(this,t,e,b(this));
r.split(/\s+/g).forEach(function(t){
(n===x?!i.hasClass(t):n)?i.addClass(t):i.removeClass(t);
});
}):this;
},
scrollTop:function(t){
if(this.length){
var n="scrollTop"in this[0];
return t===x?n?this[0].scrollTop:this[0].pageYOffset:this.each(n?function(){
this.scrollTop=t;
}:function(){
this.scrollTo(this.scrollX,t);
});
}
},
scrollLeft:function(t){
if(this.length){
var n="scrollLeft"in this[0];
return t===x?n?this[0].scrollLeft:this[0].pageXOffset:this.each(n?function(){
this.scrollLeft=t;
}:function(){
this.scrollTo(t,this.scrollY);
});
}
},
position:function(){
if(this.length){
var t=this[0],n=this.offsetParent(),e=this.offset(),i=B.test(n[0].nodeName)?{
top:0,
left:0
}:n.offset();
return e.top-=parseFloat(C(t).css("margin-top"))||0,e.left-=parseFloat(C(t).css("margin-left"))||0,
i.top+=parseFloat(C(n[0]).css("border-top-width"))||0,i.left+=parseFloat(C(n[0]).css("border-left-width"))||0,
{
top:e.top-i.top,
left:e.left-i.left
};
}
},
offsetParent:function(){
return this.map(function(){
for(var t=this.offsetParent||L.body;t&&!B.test(t.nodeName)&&"static"==C(t).css("position");)t=t.offsetParent;
return t;
});
}
},C.fn.detach=C.fn.remove,["width","height"].forEach(function(t){
var n=t.replace(/./,function(t){
return t[0].toUpperCase();
});
C.fn[t]=function(r){
var o,s=this[0];
return r===x?e(s)?s["inner"+n]:i(s)?s.documentElement["scroll"+n]:(o=this.offset())&&o[t]:this.each(function(n){
s=C(this),s.css(t,v(this,r,n,s[t]()));
});
};
}),F.forEach(function(n,e){
var i=e%2;
C.fn[n]=function(){
var n,r,o=C.map(arguments,function(e){
return n=t(e),"object"==n||"array"==n||null==e?e:X.fragment(e);
}),s=this.length>1;
return o.length<1?this:this.each(function(t,n){
r=i?n:n.parentNode,n=0==e?n.nextSibling:1==e?n.firstChild:2==e?n:null,o.forEach(function(t){
if(s)t=t.cloneNode(!0);else if(!r)return C(t).remove();
N(r.insertBefore(t,n),function(t){
null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML);
});
});
});
},C.fn[i?n+"To":"insert"+(e?"Before":"After")]=function(t){
return C(t)[n](this),this;
};
});
for(var K in C.fn)X.Z[K]=C.fn[K];
return X.uniq=S,X.deserializeValue=w,C.zepto=X,C;
}();
window.Zepto=t,void 0===window.$&&(window.$=t);
});define("biz_common/dom/attr.js",[],function(){
"use strict";
function t(t,e,n){
return"undefined"==typeof n?t.getAttribute(e):t.setAttribute(e,n);
}
function e(t,e,n,r){
t.style.setProperty?(r=r||null,t.style.setProperty(e,n,r)):"undefined"!=typeof t.style.cssText&&(r=r?"!"+r:"",
t.style.cssText+=";"+e+":"+n+r+";");
}
return{
attr:t,
setProperty:e
};
});define("biz_wap/jsapi/core.js",["biz_wap/utils/mmversion.js"],function(e,i,n,o){
"use strict";
var t=(e("biz_wap/utils/mmversion.js"),window.__moon_report||function(){}),r=8,d={},a=!1;
try{
d=top.window.document;
}catch(w){
a=!0;
}
var c={
ready:function(e){
var i=function(){
try{
e&&(window.onBridgeReadyTime=window.onBridgeReadyTime||+new Date,e());
}catch(i){
throw t([{
offset:r,
log:"ready",
e:i
}]),i;
}
window.jsapiReadyTime=Date.now();
};
a||"undefined"!=typeof top.window.WeixinJSBridge&&top.window.WeixinJSBridge.invoke?i():d.addEventListener?d.addEventListener("WeixinJSBridgeReady",i,!1):d.attachEvent&&(d.attachEvent("WeixinJSBridgeReady",i),
d.attachEvent("onWeixinJSBridgeReady",i));
},
invoke:function(e,i,n){
this.ready(function(){
return a?!1:"object"!=typeof top.window.WeixinJSBridge?(o("请在微信中打开此链接！"),!1):void top.window.WeixinJSBridge.invoke(e,i,function(i){
try{
if(n){
n.apply(window,arguments);
var o=i&&i.err_msg?", err_msg-> "+i.err_msg:"";
console.info("[jsapi] invoke->"+e+o);
}
}catch(d){
throw t([{
offset:r,
log:"invoke;methodName:"+e,
e:d
}]),d;
}
});
});
},
call:function(e){
this.ready(function(){
if(a)return!1;
if("object"!=typeof top.window.WeixinJSBridge)return!1;
try{
top.window.WeixinJSBridge.call(e);
}catch(i){
throw t([{
offset:r,
log:"call;methodName:"+e,
e:i
}]),i;
}
});
},
on:function(e,i){
this.ready(function(){
return a?!1:"object"==typeof top.window.WeixinJSBridge&&top.window.WeixinJSBridge.on?void top.window.WeixinJSBridge.on(e,function(){
try{
if(i)return i.apply(window,arguments);
}catch(n){
throw t([{
offset:r,
log:"on;eventName:"+e,
e:n
}]),n;
}
}):!1;
});
}
};
return c;
});define("pages/video_ctrl.js",[],function(){
"use strict";
function n(n){
n=n||window;
var i=n.cgiData;
return i&&2==i.ori_status&&1==i.is_mp_video&&(i.nick_name||i.hit_username)?!0:!1;
}
function i(n){
return n=n||window,!1;
}
function e(){
return-1!=r.indexOf("&vl=1")?!1:"54"==parent.window.appmsg_type?!1:!0;
}
function t(){
return-1!=r.indexOf("&dd=1")?!1:"54"==parent.window.appmsg_type?!1:!0;
}
function o(){
var n;
if(parent==window)n=window;else try{
{
parent.window.__videoDefaultRatio;
}
n=parent.window;
}catch(i){
n=window;
}
var e=n.__videoDefaultRatio||16/9;
return"54"==n.appmsg_type?e:e;
}
var r=window.location.href;
return{
showPauseTips:t,
showVideoLike:e,
showVideoDetail:i,
showReprint:n,
getRatio:o
};
});define("pages/video_plugin/video_like.js",["pages/video_plugin/base.js","pages/loadscript.js","biz_common/tmpl.js","pages/slider.js","biz_common/dom/event.js","pages/video_like.html.js"],function(e){
"use strict";
function i(){
this._g={
likePage:0,
likePageSize:3,
likeData:null
};
}
function t(e){
var i="https://sec.video.qq.com/p/like.video/fcgi-bin/like?callback=video_like_callback&otype=json&size=#size#&id=#vid#&openid=#openid#&playright=7&pidx=#pidx#&msgtype=179&tablist=9&account=#account#";
i=i.replace("#size#",e.size||9).replace("#vid#",e.vid||"").replace("#openid#",window.cgiData&&window.cgiData.txvideo_openid?window.cgiData.txvideo_openid:"").replace("#pidx#",e.pidx||0).replace("#account#",e.account||"");
var t=+new Date;
n({
url:i,
callbackName:"video_like_callback",
timeout:3e4,
callback:function(i){
var o=+new Date,n=o-t;
if(!i)return void("function"==typeof e.onError&&e.onError(-1,n));
if(0!=i.ret)return void("function"==typeof e.onError&&e.onError(-2,n));
var r=i.tablist[0],a=r.media_info;
return a&&0!=a.length?void e.onSuc({
data:a,
rtype:r.rtype,
tad:r.tab_id,
c_time:n
}):void("function"==typeof e.onError&&e.onError(-1,n));
},
onerror:function(i){
var o=+new Date,n=o-t;
"function"==typeof e.onError&&e.onError(i,n);
}
});
}
var o=e("pages/video_plugin/base.js"),n=e("pages/loadscript.js"),r=e("biz_common/tmpl.js"),a=e("pages/slider.js"),d=e("biz_common/dom/event.js"),l=e("pages/video_like.html.js");
return o.inherit(i,o.Class),i.prototype.init=function(){
this.player._debug("setBlockEvt showEndContent"),this.setBlockEvt("showEndContent");
},i.prototype.ariaReplayHandler=function(){
return this._replay(),1;
},i.prototype.showEndContentHandler=function(){
this.player._debug("show video like");
var e=this,i=this.player,o=this.player._o,n=this._g;
return n.likeData?(this._afterGetLikeInfo(),1):(n.monitorUid||(n.monitorUid=i._trigger("initMonitor",64728)),
t({
vid:o.vid,
ckey:o.ckey,
account:o.__biz,
uin:o.uin,
onSuc:function(t){
i._trigger("setMonitor",n.monitorUid,{
27:1,
28:1,
30:Math.min(t.c_time,6e4)
}),i._trigger("sendMonitor",n.monitorUid),i.extendMpReportData({
rtype:t.rtype,
tad:t.tad
}),n.likeData=t.data,n.likePage=0,e._afterGetLikeInfo();
},
onError:function(e,t){
switch(i._trigger("setMonitor",n.monitorUid,{
27:1,
29:1,
30:Math.min(t,6e4)
}),1*e){
case-1:
i.extendMpReportData({
videoerror:3
}),i._trigger("setMonitor",n.monitorUid,{
34:1
});
break;

case-2:
i._trigger("setMonitor",n.monitorUid,{
35:1
});
break;

case 500:
i.extendMpReportData({
videoerror:31
}),i._trigger("setMonitor",n.monitorUid,{
31:1
});
break;

case 400:
i.extendMpReportData({
videoerror:32
}),i._trigger("setMonitor",n.monitorUid,{
32:1
});
break;

default:
i.extendMpReportData({
videoerror:33
}),i._trigger("setMonitor",n.monitorUid,{
33:1
});
}
i._trigger("sendMonitor",n.monitorUid),n.likeData=null;
var o=i._g.myPlayer,r=o.getEndDom();
r.html(""),r.hide(),i.__showEndContentHandler();
}
}),1);
},i.prototype._afterGetLikeInfo=function(){
this._showLike(),this._bindLikeEvent();
},i.prototype._showLike=function(){
for(var e=this.player,i=e.getMpReportData(),t=this._g,o=t.likePage,n=t.likePageSize,d=t.likeData,p=-1,_=[],s=0,c=d.length;c>s;s++)s%n==0&&(p++,
_[p]=[]),_[p].push(d[s]);
var g=e._g.myPlayer,f=g.getEndDom();
f.html(r.tmpl(l,{
like:_,
cur:o
})),f.show();
var k=window.parent.window.innerHeight||window.parent.document.documentElement.clientHeight,u=f.height(),v=!0;
u>2*k/3&&(v=!1),new a({
stopMoveEvent:v,
titleId:"like_title",
titleTag:"span",
contentId:"like_info_dd",
contentTag:"dd",
func:function(e){
var t=0,o=e*n;
for(d.length;;o++){
if(t++,t>n)return;
var r=d[o];
if(!r)return;
""==i.like_kv_vid?i.like_kv_vid=r.id:-1==i.like_kv_vid.indexOf(r.id)&&(i.like_kv_vid+="+"+r.id),
""==i.like_kv_alginfo?i.like_kv_alginfo=r.alginfo:-1==i.like_kv_alginfo.indexOf(r.alginfo)&&(i.like_kv_alginfo+="+"+r.alginfo);
}
}
});
},i.prototype._replay=function(){
var e=(this._g,this.player),i=e._g.myPlayer,t=i.getEndDom();
t.html(""),t.hide(),e._trigger("replay");
},i.prototype._bindLikeEvent=function(){
var e=this,i=(this._g,this.player),t=i._g.myPlayer,o=(i.getMpReportData(),t.getEndDom());
d.tap(o.find(".js_replay")[0],function(){
e._replay();
}),d.tap(o.find("dl[id=like_info_dd]")[0],function(e){
var t=e.target||e.srcElement,n=o.find("dl[id=like_info_dd]")[0],r="li";
if(t.nodeName.toLowerCase()!=r)for(;t=t.parentNode;){
if(t==n||t==document.body||t==document){
t=null;
break;
}
if(t.nodeName.toLowerCase()==r)break;
}
if(t){
var a=t.getAttribute("data-id"),d=t.getAttribute("data-id_type"),l=t.getAttribute("data-alginfo"),p=t.getAttribute("data-pcurl");
i._trigger("openapp",{
id:a,
id_type:d,
alginfo:l,
pc_open_url:p,
fromId:760
});
}
});
},i.prototype.beforeOpenAppHandler=function(){
var e=arguments[1].res,i=arguments[1].instance,t=e.type,o=i._o.vid,n=i._o.alginfo;
n&&this._setLikeClickReport(t,o,n);
},i.prototype.getAppDownloadDomHandler=function(){
var e,i=(this._g,this.player),t=i._g.myPlayer;
if(t&&t.isEnd()){
e=$("#end_download");
var n={
main:e,
progress_main:e.find(".js_progress_main"),
download_btn:e.find(".js_download_btn"),
progress_text:e.find(".js_progress_text"),
suc_main:e.find(".js_suc_main"),
progress:e.find(".js_progress"),
suc_text:e.find(".js_suc_text")
};
return{
data:n,
code:7
};
}
return o.BASE_BITSET;
},i.prototype.openAppPcUrlHandler=function(){
var e=arguments[1].instance,i=e._o.vid,t=e._o.alginfo;
t&&this._setLikeClickReport(1,i,t);
},i.prototype._setLikeClickReport=function(e,i,t){
var o=this.player.getMpReportData();
o.like_click_type=e,""==o.like_click_vid?o.like_click_vid=i:-1==o.like_click_vid.indexOf(i)&&(o.like_click_vid+="+"+i),
""==o.like_click_alginfo?o.like_click_alginfo=t:-1==o.like_click_alginfo.indexOf(t)&&(o.like_click_alginfo+="+"+t);
},i;
});define("pages/video_plugin/video_app.js",["pages/iframe_communicate.js","pages/video_plugin/base.js","pages/loadscript.js","biz_wap/jsapi/core.js","pages/video_plugin/sha1.js","biz_common/dom/event.js","pages/app_open.js"],function(o,t,a,n){
"use strict";
function e(){
this._g={
appInfo:{},
downloadStatus:{
progress:0,
status:0,
androidDownloadId:null
}
},this._defineEvent();
}
function i(o){
if(m.loadingMd5!==!0&&"function"==typeof o.callback){
var t=d({
vid:o.vid,
id:o.id,
id_type:o.id_type,
fromId:o.fromId
});
if(t.android_md5||"android"!=m.system)return void o.callback(t);
var a=o.callbackName||"DownInfoCallback",n="https://sec.video.qq.com/p/mcgi.v/commdatav2?cmd=39&confid="+o.fromId+"&platform=aphone&callback="+a;
m.loadingMd5=!0,p({
url:n,
timeout:3e4,
callbackName:a,
callback:function(a){
m.loadingMd5=!1,a&&a.md5&&(t.android_md5=a.md5,m.android_md5=a.md5),o.callback(t);
},
onerror:function(){
m.loadingMd5=!1;
}
});
}
}
function d(o){
var t="video_id="+o.id;
return 1==o.id_type?t="cover_id="+o.id:2==o.id_type&&(t="column_id="+o.id),{
packageUrl:m.packageUrl,
packageName:m.packageName,
ios_open_url:"tenvideo2://?action=5&callback=weixin%3A%2F%2F&sender=%e5%be%ae%e4%bf%a1&"+t+"&from="+o.fromId+"&wxplugopenid="+(window.cgiData&&window.cgiData.txvideo_openid?window.cgiData.txvideo_openid:""),
android_open_url:m.android_open_url.replace("#defaultArg#",t).replace("#fromId#",o.fromId),
wp_open_url:"",
pc_open_url:"http://v.qq.com/page/"+o.vid+".html",
wp_download_url:"",
ios_download_url:"https://itunes.apple.com/cn/app/id458318329?mt=8",
android_md5:m.android_md5,
android_download_url:"http://mcgi.v.qq.com/commdatav2?cmd=4&platform=aphone&confid="+o.fromId,
task_name:"腾讯视频",
title:"腾讯视频",
thumb_url:"http://i.gtimg.cn/qqlive/images/20150608/logo_app.png",
download_fail_callback:function(){
setTimeout(function(){
n("腾讯视频户端下载失败，请检查下载任务");
},0);
},
check_downloading_callback:function(){
setTimeout(function(){
n("正在下载腾讯视频户端，请稍后");
},0);
}
};
}
function s(o){
w.checkInstallState({
callback:o,
packageUrl:m.packageUrl,
packageName:m.packageName
});
}
o("pages/iframe_communicate.js");
var r=o("pages/iframe_communicate.js"),l=o("pages/video_plugin/base.js"),p=o("pages/loadscript.js"),_=o("biz_wap/jsapi/core.js"),c=o("pages/video_plugin/sha1.js"),u=o("biz_common/dom/event.js"),w=o("pages/app_open.js"),m={
debug:window.parent.window.location.href.indexOf("&vconsole=1")>=0?!0:!1,
android_md5:"",
system:w.getSystemType(),
loadingMd5:!1,
packageUrl:"tenvideo2://",
packageName:"com.tencent.qqlive",
sha1_key:"e6673c1cda34653754ab03792617eda636c5ff",
android_open_url:"tenvideo2://?action=5&jumpaction=1000&sender=%e5%be%ae%e4%bf%a1&#defaultArg#&from=#fromId#&wxplugopenid="+(window.cgiData&&window.cgiData.txvideo_openid?window.cgiData.txvideo_openid:"")
};
return l.inherit(e,l.Class),e.prototype.init=function(){
this.setBlockEvt("openapp"),this._removePostmessageListener(),this._addPostmessageListener();
},e.prototype.destroy=function(){
this._removePostmessageListener();
},e.prototype._defineEvent=function(){
var o=this;
this._g._event={
txAppDownloadStatusChanged:function(t){
var a=o._g.downloadStatus,n=t.downloadStatus;
for(var e in n)a.hasOwnProperty(e)&&(a[e]=n[e]);
}
};
},e.prototype._removePostmessageListener=function(){
r.removeListener({
type:"txAppDownloadStatusChanged",
func:this._g._event.txAppDownloadStatusChanged
});
},e.prototype._addPostmessageListener=function(){
r.addListener({
type:"txAppDownloadStatusChanged",
func:this._g._event.txAppDownloadStatusChanged
});
},e.prototype.playerReadyHandler=function(){
var o=this,t=(this._g,this.player),a=this._getDownloadDom();
return u.tap(a.main[0],function(){
t._trigger("openapp",{
vid:t._o.vid,
id:t._o.vid,
fromId:787
});
}),s(function(t){
t&&o._setDownloadStatus({
status:2
});
}),l.BASE_BITSET;
},e.prototype.userplayHandler=function(){
var o=this._getDownloadDom();
return o.main.hide(),l.BASE_BITSET;
},e.prototype.userpauseHandler=function(){
var o=this._g;
if(this._beforeAndroidDownload(!1)!==!1){
this._setDownloadStatus({
progress:0
}),o.downloadTimeoutId&&window.clearTimeout(o.downloadTimeoutId);
var t=this._getDownloadDom();
t.main.show(),this._showDownloadStatus();
}
return l.BASE_BITSET;
},e.prototype.openappHandler=function(){
var o=arguments[1],t=this,a=this.player,n=this._g,e=o.id,d=o.id,s=o.id_type,r=o.alginfo,l=o.pc_open_url,p=n.appInfo[e];
return p?(p.open(),1):(i({
vid:e,
id:d,
id_type:s,
fromId:o.fromId,
callback:function(i){
i.alginfo=r||"",i.vid=e,i.id=d,i.pc_open_url=l||"",i.id_type=s,i.fromId=o.fromId,
i.before_open_callback=function(o){
t._clearCommData(),a._trigger("beforeOpenApp",{
res:o,
instance:this
});
},i.final_fail_callback=function(){
var o=this._o.pc_open_url;
o&&(a._trigger("openAppPcUrl",{
instance:this
}),top!=window?window.parent.window.location.href=o:window.location.href=o);
},i.beforeDownload=function(){
return t._beforeAndroidDownload(!0);
},i.download_start_callback=function(){
t._androidDownloadStart(this._o);
},i.download_complete_callback=function(){
t._androidDownloadComplete();
},i.download_fail_callback=function(){
t._androidDownloadFail(!0);
},i.download_remove_callback=function(){
t._androidDownloadFail(!1);
},i.check_downloading_callback=function(o){
t._androidDownloading(o,!0);
},n.appInfo[e]=new w.create(i),n.appInfo[e].open();
}
}),1);
},e.prototype._writeCommData=function(o){
var t="video_id="+o.id;
1==o.id_type?t="cover_id="+o.id:2==o.id_type&&(t="column_id="+o.id);
var a=new c("SHA-1","TEXT",{
numRounds:1
}),n={
report_id:123,
from:"微信",
start_time_stamp:+new Date,
validate_time_interval:6e5,
action_url:m.android_open_url.replace("#defaultArg#",t).replace("#fromId#",o.fromId)
};
n=JSON.stringify(n),a.update(n+m.sha1_key);
var e=a.getHash("HEX"),i=JSON.stringify({
open_launch_config:{
content:n,
sha1:e
}
});
!!m.debug&&window.parent.window.console.log("data:"+i),this._writeCommDataJsapi({
data:i
});
},e.prototype._clearCommData=function(){
this._writeCommDataJsapi({
data:""
});
},e.prototype._writeCommDataJsapi=function(o){
_.invoke("writeCommData",{
packageName:m.packageName,
data:o.data||""
},function(t){
!!m.debug&&window.parent.window.console.log("writeCommData res:"+JSON.stringify(t)),
/:ok$/.test(t.err_msg)?"function"==typeof o.onSuccess&&o.onSuccess():"function"==typeof o.onError&&o.onError();
});
},e.prototype._androidDownloadFail=function(o){
this._clearCommData(),this._stopDownloadBar(),o===!0&&setTimeout(function(){
n("腾讯视频户端下载失败，请检查检查网络状态或稍后再试");
},0);
},e.prototype._stopDownloadBar=function(){
this._setDownloadStatus({
status:0,
androidDownloadId:null,
progress:0
}),this._resetDownloadBar(!1);
},e.prototype._androidDownloadComplete=function(){
this._completeDownloadBar();
},e.prototype._resetDownloadBar=function(o){
var t=this._g;
t.downloadTimeoutId&&window.clearTimeout(t.downloadTimeoutId);
var a=this._getDownloadDom();
this._updateDownloadBar(),o?a.main.show():a.main.hide(),this._showDownloadStatus();
},e.prototype._downloadProgressTimeout=function(){
var o=this,t=this._g;
t.downloadTimeoutId&&window.clearTimeout(t.downloadTimeoutId),t.downloadTimeoutId=setTimeout(function(){
var t=o._getDownloadStatus();
if(1*t.status===1){
var a=Math.min(t.progress+5,90);
o._updateDownloadBar(a),o._downloadProgressTimeout();
}else 1*t.status===2?o._completeDownloadBar():o._resetDownloadBar(!1);
},500);
},e.prototype._startDownloadBar=function(){
this._setDownloadStatus({
status:1
}),this._resetDownloadBar(!0),this._downloadProgressTimeout();
},e.prototype._androidDownloadStart=function(o){
this._setDownloadStatus({
progress:0,
androidDownloadId:o.id
}),this._startDownloadBar(),this._writeCommData(o);
},e.prototype._beforeAndroidDownload=function(o){
var t=this._getDownloadStatus();
return 1*t.status===1?(this._androidDownloading(t.androidDownloadId,o),!1):1*t.status===2?(this._completeDownloadBar(o),
!1):void 0;
},e.prototype._completeDownloadBar=function(o){
var t=this._g,a=this._getDownloadStatus();
a.androidDownloadId&&o?w.install(a.androidDownloadId):o&&n("腾讯视频户端下载完成，请检查下载任务并安装"),
t.downloadTimeoutId&&window.clearTimeout(t.downloadTimeoutId),this._updateDownloadBar(100),
this._setDownloadStatus({
status:2
});
var e=this._getDownloadDom();
e.main.show(),this._showDownloadStatus();
},e.prototype._showDownloadStatus=function(o){
var t=this._getDownloadStatus();
o=o||this._getDownloadDom(),0==t.status?(o.progress_main.hide(),o.download_btn.show().find(".js_download_text").text("下载"),
o.main.find(".js_installStatus").text("安装"),o.suc_main.hide()):1==t.status?(o.progress_main.show(),
o.main.find(".js_installStatus").text("安装"),o.download_btn.hide(),o.suc_main.hide()):2==t.status&&(o.progress_main.hide(),
o.download_btn.show().find(".js_download_text").text("打开"),o.main.find(".js_installStatus").text("打开"),
o.suc_main.show());
},e.prototype._updateDownloadBar=function(o){
var t=this._getDownloadDom(),a=o||this._getDownloadStatus().progress||0;
this._setDownloadStatus({
progress:a
}),t.progress.css({
width:a+"%"
}),t.progress_text.text(a+"%");
},e.prototype._getDownloadDom=function(){
return this.player._trigger("getAppDownloadDom");
},e.prototype._androidDownloading=function(o,t){
t&&n("正在下载腾讯视频户端，请稍后"),this._startDownloadBar();
},e.prototype._setDownloadStatus=function(o){
r.broadcastMessage({
type:"txAppDownloadStatusChanged",
data:{
downloadStatus:o
}
});
},e.prototype._getDownloadStatus=function(){
return this._g.downloadStatus;
},e;
});define("pages/video_plugin/pause_tips.js",["pages/video_plugin/base.js"],function(s){
"use strict";
function e(){
this._g={};
}
var n=s("pages/video_plugin/base.js");
return n.inherit(e,n.Class),e.prototype.hidePauseTipsHandler=function(){
this.getDownloadDom().main.hide();
},e.prototype.getAppDownloadDomHandler=function(){
var s=(this._g,this),e=this.player,i=e._g.myPlayer;
return i&&!i.isEnd()?{
data:s.getDownloadDom(),
code:7
}:n.BASE_BITSET;
},e.prototype.getDownloadDom=function(){
var s=$("#ing_download_"+this.player._g.myPlayer.id),e={
main:s,
progress_main:s.find(".js_progress_main"),
download_btn:s.find(".js_download_btn"),
progress_text:s.find(".js_progress_text"),
suc_main:s.find(".js_suc_main"),
progress:s.find(".js_progress"),
suc_text:s.find(".js_suc_text")
};
return e;
},e;
});function _typeof(e){
return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e;
}
define("pages/qq_video_info.js",["biz_wap/zepto/zepto.js","biz_wap/zepto/event.js","biz_wap/zepto/touch.js","biz_common/utils/string/html.js","a/a_utils.js","pages/iframe_communicate.js","biz_wap/jsapi/core.js","biz_wap/utils/mmversion.js","biz_common/utils/url/parse.js","biz_wap/utils/ajax.js","pages/loadscript.js","pages/video_plugin/video_monitor.js","biz_wap/utils/localstorage.js","biz_wap/utils/storage.js","pages/version4video.js","biz_common/dom/event.js","pages/report.js","biz_common/dom/attr.js","new_video/plugin/proxy.js","new_video/plugin/ad.js","new_video/player.js","new_video/ctl.js","biz_common/tmpl.js","pages/video_error.html.js","pages/create_txv.js","biz_wap/utils/jsmonitor_report.js"],function(e){
"use strict";
function t(e){
this._o={
headImgUrl:"",
jsapiFullScreen:!0,
canShareVideo:!0,
videoMd5:"",
pauseShowControll:!0,
preview:!1,
isInIframe:!1,
fromid:0,
ori_status:3,
is_mp_video:0,
plugins:[],
oriVid:"",
vid:"",
ckey:"",
ckey_ad:"",
width:0,
height:0,
container:"",
autoplay:!1,
loop:!1,
resume:A.resume,
__biz:"",
uin:"",
mid:"",
idx:"",
comment_id:"",
scene_type:0,
hit_bizuin:"",
hit_vid:"",
totalRange:10,
noAd:!1,
isVideoSharePage:!1,
onReady:function(){},
onUserplay:function(){}
},l(this._o,e),(!A.isWechat||!A.isIOS&&!A.isAndroid||A.isIOS&&w.ltVersion("7.0.9",!1)||A.isAndroid&&w.ltVersion("7.0.10",!1)||!this._o.videoMd5)&&(this._o.jsapiFullScreen=!1,
this._o.canShareVideo=!1),this._o.is_mp_video||(this._o.pauseShowControll=!1),!this._o.headImgUrl&&this._o.jsapiFullScreen&&A.isAndroid&&(this._o.headImgUrl="http://mmbiz.qpic.cn/mmbiz/a5icZrUmbV8p5jb6RZ8aYfjfS2AVle8URwBt8QIu6XbGewB9wiaWYWkPwq4R7pfdsFibuLkic16UcxDSNYtB8HnC1Q/0"),
this._o.oriVid=this._o.oriVid||this._o.vid,1!=this._o.ori_status&&2!=this._o.ori_status&&(this._o.ori_status=3),
this._init();
}
function i(e){
function t(){
k({
type:"GET",
dataType:"json",
timeout:3e4,
url:a,
success:function(e){
if(e&&e.base_resp&&0==e.base_resp.ret){
var t="",i=void 0;
if(e.is_mp_video_delete?(t="该视频已被发布者删除",i=72):e.is_mp_video_forbid?(t="该视频因违规已下架",
i=73):1*e.is_mp_video_transing===1?(t="正在转码，转码完成后可播放",i=78):e.is_mp_video_checking?(t="审核中",
i=75):e.is_mp_video_check_fail?(t="审核失败",i=76):1*e.is_appmsg_unauthorized===1&&(t="该视频因未经授权使用而无法查看",
i=77),t&&"undefined"!=typeof i)return void n({
err_msg:t,
code:i
});
if(e.url_info&&e.url_info.length>0){
var r=function(){
for(var t=function g(t){
var r=Math.floor(Math.max(t.width,t.height));
if(r>3841)switch(1*t.format_id){
case 10002:
t=e.url_info[i["480p"].index],O.setSum(27302,6,1),g(t);
break;

case 10003:
t=e.url_info[i["270p"].index],O.setSum(27302,7,1);
}
return t;
},i={},r=0;r<e.url_info.length;r++){
var n=e.url_info[r];
switch(1*n.format_id){
case 10002:
i["720p"]={
index:r
};
break;

case 10003:
i["480p"]={
index:r
};
break;

case 10004:
i["270p"]={
index:r
};
}
}
var a=void 0;
1*e.is_mp_video_urgent_state===1?i["270p"]?a=e.url_info[i["270p"].index]:i["480p"]&&(a=e.url_info[i["480p"].index]):A.isPc||"wifi"==A.networkType?i["720p"]?a=e.url_info[i["720p"].index]:i["480p"]&&(a=e.url_info[i["480p"].index]):i["480p"]?a=e.url_info[i["480p"].index]:i["720p"]&&(a=e.url_info[i["720p"].index]),
a||(a=e.url_info[0]),a=t(a);
var s=Math.floor(a.duration_ms/1e3),d=(parseFloat(a.filesize)/1024/1024).toFixed(2),_={
formatid:a.format_id,
time:s,
title:a.title||"",
width:a.width,
height:a.height,
file_size:a.filesize,
totalUrl:a.url,
rate:Math.round(a.filesize/1024*8/s),
flow:d
};
return o({
data:_
}),{
v:void 0
};
}();
if("object"===("undefined"==typeof r?"undefined":_typeof(r)))return r.v;
}
n({
err_msg:U,
code:71
});
}else n({
err_msg:"当前视频不存在，暂无法观看",
code:74
});
},
error:function(e){
var t=void 0;
t=e?e.status>=200&&e.status<400?81:e.status>=400&&e.status<500?82:e.status>=500&&e.status<600?83:0==e.status&&4==e.readyState?84:85:80,
n({
err_msg:U,
code:t
});
}
});
}
var i=e.retry||1,o="function"==typeof e.onSuccess?e.onSuccess:function(){},n=function(r){
return r&&r.code>=80&&r.code<=85&&i>0?(i--,void t()):void("function"==typeof e.onError&&e.onError(r));
},a=["/mp/videoplayer?action=get_mp_video_play_url","&preview=",e.preview?"1":"0","&__biz=",e.__biz,"&mid=",e.mid,"&idx=",e.idx,"&vid=",e.vid].join("");
r(t);
}
function r(e){
window.networkType||A.networkType||A.isPc?e():F?y.invoke("getNetworkType",{},function(t){
A.networkType=q[t.err_msg]||"fail",("network_type:edge"==t.err_msg||"network_type:wwan"==t.err_msg)&&(t.detailtype||t.subtype)&&(A.networkType=t.detailtype||t.subtype),
e();
}):e();
}
function o(e){
function t(){
M({
url:i,
timeout:3e4,
callbackName:"video_dynamic_callback",
callback:function(t){
var i=+new Date,r=i-o;
t=t||{},"undefined"==typeof t.em&&(t.em=0);
var a=t.em,s=void 0;
if(!b.getQuery("channel_session_id")||61!==t.em&&62!==t.em||k({
type:"POST",
dataType:"json",
timeout:3e4,
url:"/mp/videochannel_profile_page",
data:{
action:"report_tx_video",
vid:e.vid,
status:t.em
},
success:function(e){
console.log(e);
}
}),0==t.em){
if(t.exem>0?a=-4:0==t.exem&&t.vl&&t.vl.vi&&t.vl.vi[0]&&8==t.vl.vi[0].st&&(a=t.preview>0?-5:-3),
0!=a||t.vl&&t.vl.vi&&t.vl.vi[0]||(a=-2),0==a){
var d=t.vl.vi[0];
if(s={
newVid:d.lnk,
time:Math.floor(d.td),
title:d.ti,
width:d.vw,
height:d.vh,
file_size:d.fs,
rate:Math.round(d.fs/1024*8/d.td),
flow:(parseFloat(d.fs)/1024/1024).toFixed(2)
},d.ul&&d.ul.ui&&d.ul.ui[0]){
var _=d.ul.ui[0],g=_.url+d.fn,c=t.fl,p="";
if(c&&c.cnt>0){
for(var l=c.fi,u={},h=0;h<l.length;h++){
var v=l[h];
switch(v.name){
case"msd":
u["270P"]={
index:h
};
break;

case"mp4":
u["480p"]={
index:h
};
}
var m;
A.isPc||"wifi"==A.networkType?u["480p"]?m=l[u["480p"].index]:u["270P"]&&(m=l[u["270P"].index]):u["270P"]?m=l[u["270P"].index]:u["480p"]&&(m=l[u["480p"].index]),
m||(m=l[0]),s.formatid=m.id,p=m.name,s.resolution=(m.cname||"").replace(/^.*;\((:?.*)P\)$/,"$1")||0;
}
s.format=p,s.vt=_.vt,s.totalUrl=[g,-1!=g.indexOf("?")?"&":"?","vkey=",d.fvkey,"&sdtfrom=",x.getsdtfrom(),"&type=",1==_.dt?"tflv":2==_.dt||0==_.dt?"mp4":"","&platform=",x.getPlatformType(),"&fmt=",p,"&level=",d.level,"&br=",d.br,"&sp=",d.sp].join("");
}else a=-2;
}
}else a=t.em;
0==a?(x.getinfoReport({
vid:e.vid,
val:r,
val1:a,
vurl:s.totalUrl
}),e.onSuc({
data:s,
oriData:t,
c_time:r,
ret_code:a
})):(x.getinfoReport({
vid:e.vid,
val:r,
val1:a,
vurl:""
}),e.onError(-2,{
ret_code:a,
c_time:r,
err_msg:n(1*a,1*t.exem,t)
}));
}else e.onError(a,{
ret_code:a,
c_time:r,
err_msg:n(a)
});
},
onerror:function(t){
var i=void 0,r=+new Date,a=r-o;
switch(1*t){
case 400:
i=-22;
break;

case 500:
i=-21;
break;

default:
i=-23;
}
"function"==typeof e.onError&&e.onError(i,{
ret_code:i,
c_time:a,
err_msg:n(-1)
}),x.getinfoReport({
vid:e.vid,
val:a,
val1:i,
vurl:""
});
}
});
}
var i="https://h5vv6.video.qq.com/getvinfo?vid=#vid#&dtype=1&otype=json&callback=video_dynamic_callback&appVer=1&encryptVer=6.3&platform=61001&cKey=#ckey#&sdtfrom=#sdtfrom#";
i=i.replace("#vid#",e.vid).replace("#ckey#",e.ckey).replace("#sdtfrom#",x.getsdtfrom()),
i=i+"&device="+x.getPlatformType()+"&use_proxy_sdk="+(D.isUseProxy()?1:0);
var o=+new Date;
r(t);
}
function n(e,t){
var i="";
switch(1*e){
case-4:
i="因版权限制，该视频不支持播放";
break;

case-5:
i="因版权限制，该视频不支持播放";
break;

case-3:
i="因版权限制，该视频不支持播放";
break;

case 61:
i="当前视频不存在，暂无法观看";
break;

case 62:
i="当前视频已下架，暂无法观看";
break;

case 63:
i="视频加载失败，暂无法观看";
break;

case 65:
i="视频加载失败，暂无法观看";
break;

case 67:
i="视频加载失败，暂无法观看";
break;

case 69:
i="视频格式不支持移动端观看，请在电脑上观看";
break;

case 71:
i="视频加载失败，暂无法观看";
break;

case 73:
i="视频加载失败，暂无法观看";
break;

case 74:
i="视频加载失败，暂无法观看";
break;

case 80:
switch(1*t){
case 1:
i="很抱歉，当前IP地址所在地区暂不支持播放";
break;

case 2:
i="因版权限制，暂不支持播放";
break;

default:
i="因版权限制，该视频不支持播放";
}
break;

case 81:
i="视频加载失败，暂无法观看";
break;

case 82:
i="视频加载失败，暂无法观看";
break;

case 83:
switch(1*t){
case-1:
i=U;
break;

case-2:
i="因版权限制，该视频不支持播放";
break;

default:
i="该片为付费视频，请前往腾讯视频观看";
}
break;

case 84:
i="很抱歉，根据您的IP地址，暂无法播放";
break;

default:
i=U;
}
return i;
}
function a(e){
var t="https://h5vv.video.qq.com/getextinfo?otype=json&callback=video_static_callback&vid="+e.vid;
M({
url:t,
timeout:3e4,
callbackName:"video_static_callback",
callback:function(t){
if(!t||"o"!=t.s||t.vl.cnt<=0)return void("function"==typeof e.onError&&e.onError(-1));
var i=t.vl.vi[0],r={
title:i.title||"视频",
desc:1*i.desc===0?"":i.desc||"",
director:i.director||"",
leading_actor:i.leading_actor||"",
costar:i.costar||"",
time:Math.floor(i.td)||0
};
if(i.pl&&i.pl.cnt>0){
var o=i.pl.pi;
r.p400_300=o[0]?o[0].url:"",r.p140_100=o[1]?o[1].url:"",r.p120_90=o[2]?o[2].url:"",
r.p400_300=r.p400_300&&-1==r.p400_300.indexOf("http")?"http://"+r.p400_300:r.p400_300,
r.p140_100=r.p140_100&&-1==r.p140_100.indexOf("http")?"http://"+r.p140_100:r.p140_100,
r.p120_90=r.p120_90&&-1==r.p120_90.indexOf("http")?"http://"+r.p120_90:r.p120_90;
}
e.onSuc(r);
},
onerror:function(t){
"function"==typeof e.onError&&e.onError(t);
}
});
}
function s(e){
for(var t=1e8,i=0,r=0,o=e.length;o>r;r++)i=(i<<5)+i+e.charCodeAt(r);
return i%t;
}
function d(e,t,i){
return i?"/mp/videoplayer?action=get_mp_video_cover&vid="+e:location.protocol+"//puui.qpic.cn/qqvideo/0/"+e+"/0";
}
function _(e){
var t=P.get(A.cachekey+e);
if(!t)return null;
try{
if(t=JSON.parse(t)||{},!t.time||(new Date).getTime()-A.cacheTime>1*t.time)return c(e),
null;
}catch(i){
return c(e),null;
}
return t.videoInfo||null;
}
function g(e,t){
var i={
dynamicData:null,
status:t.status||null
};
P.set(A.cachekey+e,JSON.stringify({
time:(new Date).getTime(),
videoInfo:i
}));
}
function c(e){
P.remove(A.cachekey+e);
}
function p(e){
return document.getElementById(e);
}
function l(e,t){
for(var i in t)e[i]=t[i];
}
function u(){
h(),v();
}
function h(){
y.invoke("getNetworkType",{},function(e){
A.networkType=q[e.err_msg]||"fail",("network_type:edge"==e.err_msg||"network_type:wwan"==e.err_msg)&&(e.detailtype||e.subtype)&&(A.networkType=e.detailtype||e.subtype);
});
}
function v(){
j.on(window,"load",function(){
if(window.__wxjs_is_wkwebview){
A.videoDataLs=new R("video_report_11949");
var e=A.videoDataLs.getData();
for(var t in e){
var i=+new Date;
i-(e[t].exp-A.videoDataLsExpTime)>6e4&&(x.videoreport({
data:e[t].val,
async:!0
}),A.videoDataLs.remove(t));
}
A.neeedTimoutSaveReportData=!0;
}else A.neeedTimoutSaveReportData=!1;
}),j.on(window,"unload",function(){
for(var e=0;e<A.videoInstance.length;e++){
var t=A.videoInstance[e];
t.mpVideoReport(),t.destroy();
}
});
}
-1!=location.href.indexOf("__td=qq.com")&&(document.domain="qq.com"),e("biz_wap/zepto/zepto.js"),
e("biz_wap/zepto/event.js"),e("biz_wap/zepto/touch.js"),e("biz_common/utils/string/html.js");
var m=e("a/a_utils.js"),f=e("pages/iframe_communicate.js"),y=e("biz_wap/jsapi/core.js"),w=e("biz_wap/utils/mmversion.js"),b=e("biz_common/utils/url/parse.js"),k=e("biz_wap/utils/ajax.js"),M=e("pages/loadscript.js"),T=e("pages/video_plugin/video_monitor.js"),P=e("biz_wap/utils/localstorage.js"),R=e("biz_wap/utils/storage.js"),D=e("pages/version4video.js"),j=e("biz_common/dom/event.js"),x=e("pages/report.js"),I=(e("biz_common/dom/attr.js"),
e("new_video/plugin/proxy.js")),S=e("new_video/plugin/ad.js"),z=e("new_video/player.js"),C=e("new_video/ctl.js"),E=e("biz_common/tmpl.js"),V=e("pages/video_error.html.js"),U="视频加载失败，请刷新页面重试",L=e("pages/create_txv.js"),O=e("biz_wap/utils/jsmonitor_report.js"),A={
isUseProxy:D.isUseProxy(),
isWechat:w.isWechat,
isAndroid:w.isAndroid,
isIOS:w.isIOS,
isGoTx:window.parent.window.location.href.indexOf("&_gotx=1")>0,
_debug:window.parent.window.location.href.indexOf("&vconsole=1")>0,
cachekey:"qqmovieStatus_",
videoDataLs:null,
videoDataLsExpTime:864e7,
cacheTime:3e5,
videoInfo:{},
videoInstance:[],
neeedTimoutSaveReportData:!0,
networkType:"",
isPc:/(WindowsNT)|(Windows NT)|(Macintosh)/i.test(navigator.userAgent)
},q={
"network_type:fail":"fail",
"network_type:edge":"2g/3g",
"network_type:wwan":"2g/3g",
"network_type:wifi":"wifi"
};
u(),t.prototype._init=function(e){
function t(){
try{
for(var e=window.parent.document.getElementsByTagName("iframe"),t=0;t<e.length;t++)if(window===e[t].contentWindow&&e[t].adVidFromAppmsg||e[t].adVidFromAppmsg===window.realVid&&window.realVid)return!0;
}catch(i){}
}
e=e||{},this.destroy(),A.videoInstance.push(this),this._report=x.getVideoReportData(),
this._g={
gWidth:e.gWidth||this._o.width,
gHeight:e.gHeight||this._o.height,
playRangeInfo:[],
dynamicErrMsg:"",
hasReportProxyError:e.hasReportProxyError===!0,
noProxy:e.noProxy===!0,
hasDestroy:!1,
reportDataTimeoutId:null,
reportDataLsKey:this._o.vid+"_"+Math.random(),
hasReport:!1,
isShowTx:!1,
dataCount:0,
targetDataCount:2,
coverUrl:"",
vInfo:{
status:null,
dynamicData:null,
staticData:null,
is_report_pv:!1
},
dom:{
page_content:p("page-content"),
js_mpvedio:p("js_mpvedio")
}
},this._getRatio(),this._initPlugins(e),this._initReportData(),this._defineEvent(),
m.report115849(71);
var i=setInterval(function(){
window.adVidFromAppmsg&&(m.report115849(75),clearInterval(i));
},500),r=setInterval(function(){
t()&&(m.report115849(76),clearInterval(r));
},500);
if(this._isGotoTx()===!0)return void m.report115849(70);
var n=setInterval(function(){
window.adVidFromAppmsg&&(m.report115849(83),clearInterval(n));
},500),a=setInterval(function(){
t()&&(m.report115849(84),clearInterval(a));
},500);
this._getCache(),this.setCoverUrl(),this._getDynamic(),this._reportH265VideoSupport();
var s=this;
D.isUseAd()&&this._o.noAd!==!0&&(this._g.myAdPlugin=new S({
fromid:this._o.fromid,
videoReportType:this.getReportTypeBySceneType(),
isMpVideo:s._o.is_mp_video,
vid:this._o.vid,
ratio:this._o.ratio,
oriVid:this._o.oriVid,
tmpGetAd:function(e,t){
o({
vid:"b0163rzlnn7",
ckey:s._o.ckey_ad,
onSuc:function(t){
e&&e(t);
},
onError:function(){
t&&t();
}
});
}
})),this._cacheReportData();
},t.prototype._getRatio=function(){
for(var e=this._o.width/this._o.height,t=[4/3,16/9],i=t[0],r=Math.abs(i-e),o=1,n=t.length;n>o;o++){
var a=Math.abs(t[o]-e);
r>a&&(r=a,i=t[o]);
}
this._o.ratio=i;
},t.prototype._isGotoTx=function(){
var e=this,t=this._o;
if((!t.ckey||A.isGoTx)&&!t.is_mp_video){
e._g.isShowTx=!0;
var i=$(this._o.container),r=i.attr("id");
r||(r="js_tx_video_container_"+Math.random(),i.attr("id",r)),L.createTxVideo({
win:window,
containerId:r,
vid:t.vid,
width:e._g.gWidth,
height:e._g.gHeight,
autoplay:!1,
allowFullScreen:!0,
onSuccess:function(t){
e._g.txPlayer=t.player,e._g.dataCount=e._g.targetDataCount,e.videoDataReady();
},
onError:function(){}
});
var o=this._g.monitorUid;
if(1==window.is_login)this._trigger("setMonitor",o,{
38:1
});else if(this._trigger("setMonitor",o,{
39:1
}),1===window.parent.is_login){
var n=JSON.stringify({
tag:"video_player_login_status",
uin:window.user_uin,
bizUin:encodeURIComponent(t.__biz),
appmsgBizUin:encodeURIComponent(window.parent.biz),
appmsgUserUin:window.parent.user_uin,
isSecOpen:!!window.parent.__second_open__
});
O.setLogs({
id:115849,
key:73,
value:1,
lc:1,
log0:n
});
}
return this._trigger("sendMonitor",o),!0;
}
return!1;
},t.prototype._reportH265VideoSupport=function(){
var e=this._g.monitorUid2;
this._trigger("setMonitor",e,{
36:1
});
var t=document.createElement("video");
if("function"==typeof t.canPlayType){
var i=t.canPlayType('video/mp4; codecs="hevc"');
("maybe"==i.toLowerCase()||"probably"==i.toLowerCase())&&this._trigger("setMonitor",e,{
37:1
});
}
this._trigger("sendMonitor",e);
},t.prototype._initPlugins=function(){
var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];
if(!e.hasInitPlugins){
var t=this._o.plugins||[];
t.push(new T),this._blockPlugin={};
for(var i=0,r=t.length;r>i;++i){
var o=t[i];
o.setPlayer(this),!!o.init&&o.init();
}
this.plugins=t;
}
},t.prototype.isInFullScreen=function(){
return this._g.myPlayer?this._g.myPlayer.isInFullScreen():!1;
},t.prototype._initReportData=function(){
var e=this._report,t=this._o;
e.mid=t.mid,e.__biz=t.__biz,e.idx=t.idx,e.vid=t.vid,e.commentid=t.comment_id,e.scene_type=t.scene_type,
e.auto_play=t.autoplay?1:0,e.fromid=t.fromid,e.hit_bizuin=t.hit_bizuin,e.hit_vid=t.hit_vid,
this._g.monitorUid=this._trigger("initMonitor",64728),this._g.monitorUid2=this._trigger("initMonitor",110644);
},t.prototype._initPlayRangeInfo=function(e){
function t(e,t){
for(var i=[{
start:0,
end:e,
hasReport:!1
}];;){
var r=i[i.length-1];
if(r.end>=t)break;
i.push({
start:r.end,
end:r.end+e,
hasReport:!1
});
}
return i;
}
if(!(e.durationMs<=0)){
var i=this._o.totalRange;
this._g.playRangeInfo=1e3*i>=e.durationMs?t(1e3,e.durationMs):t(Math.ceil(e.durationMs/i),e.durationMs);
}
},t.prototype._reportCurRangeInfo=function(e){
var t=this._g.playRangeInfo;
if(t&&0!==t.length)for(var i=t.length,r=this._o,o=0;i>o;o++){
var n=t[o];
if(n.start<e.curTime&&n.end>=e.curTime){
n.hasReport||(n.hasReport=!0,C.report({
step:14,
vid:r.vid,
hit_bizuin:r.hit_bizuin,
hit_vid:r.hit_vid,
traceid:this._getTraceId(),
orderid:this._getOrderid(),
ori_status:this._getOriStatus(),
type:this.getReportTypeBySceneType(),
fromid:this._getFromid(),
total_range:i,
current_range:o+1,
duration:this._report.duration_ms||t[i-1].end
}));
break;
}
}
},t.prototype._defineEvent=function(){
var e=this;
this._g.event={
afterRemoveLoading:function(){
e._afterRemoveLoading();
}
};
},t.prototype.videoDataReady=function(){
var e=this;
this._g.dataCount===this._g.targetDataCount&&(this._g.isShowTx?this._removeLoading():this.preLoadCover({
callback:function(){
e._g.vInfo.dynamicData?e._createPlayer({
onLoaded:function(){
setTimeout(function(){
e._removeLoading();
},0);
}
}):e._removeLoading();
}
}));
},t.prototype._removeLoading=function(){
this._o.isInIframe?(f.addListener({
type:"afterRemoveLoading",
func:this._g.event.afterRemoveLoading
}),f.postMessage({
type:"removeVideoLoading",
data:{
vid:this._o.oriVid
}
})):this._afterRemoveLoading();
},t.prototype._afterRemoveLoading=function(){
if(!this._g.isShowTx&&!this._g.vInfo.dynamicData)if(this._o.is_mp_video){
var e=1;
(72==this._report.videoerror||73==this._report.videoerror)&&(e=2),this._showError(this._g.dynamicErrMsg,e);
}else this._showError(this._g.dynamicErrMsg||"");
f.removeListener({
type:"afterRemoveLoading",
func:this._g.event.afterRemoveLoading
}),this._bindResize(),this._o.onReady.call(this);
},t.prototype.setCoverUrl=function(){
function e(){
k({
type:"GET",
dataType:"json",
timeout:3e4,
url:o,
success:function(e){
e&&e.base_resp&&0==e.base_resp.ret&&e.url&&(t._g.coverUrl=e.url),t._g.dataCount++,
t.videoDataReady();
},
error:r
});
}
if(this._g.coverUrl=this._getCover(),!this._o.is_mp_video)return this._g.dataCount++,
void this.videoDataReady();
var t=this,i=1,r=function(){
return i>0?(i--,void e()):(t._g.dataCount++,void t.videoDataReady());
},o=this._g.coverUrl+"&f=json";
e();
},t.prototype._getDynamic=function(){
var e=this,t=this._o,r=this._g;
if(r.vInfo.dynamicData){
r.dataCount++;
var n=r.vInfo.dynamicData;
return this._report.getvinfo_ret="undefined"!=typeof n.ret_code?n.ret_code:-2,this._report.getvinfo_time=n.c_time||0,
void this.videoDataReady();
}
var a=this._report,s=r.monitorUid,d=r.monitorUid2;
return t.is_mp_video?void i({
preview:t.preview,
vid:t.vid,
__biz:t.__biz,
mid:t.mid,
idx:t.idx,
onSuccess:function(t){
e._trigger("setMonitor",d,{
4:1,
5:1
}),e._trigger("sendMonitor",d),r.dataCount++,r.vInfo.dynamicData=t,e.videoDataReady();
},
onError:function(t){
switch(e._trigger("setMonitor",d,{
4:1,
6:1
}),1*t.code){
case 80:
e._trigger("setMonitor",d,{
7:1,
24:1
});
break;

case 81:
e._trigger("setMonitor",d,{
7:1,
25:1
});
break;

case 82:
e._trigger("setMonitor",d,{
7:1,
26:1
});
break;

case 83:
e._trigger("setMonitor",d,{
7:1,
27:1
});
break;

case 84:
e._trigger("setMonitor",d,{
7:1,
28:1
});
break;

case 85:
e._trigger("setMonitor",d,{
7:1,
29:1
});
break;

case 71:
e._trigger("setMonitor",d,{
8:1
});
break;

case 72:
e._trigger("setMonitor",d,{
9:1
});
break;

case 73:
e._trigger("setMonitor",d,{
10:1
});
break;

case 74:
e._trigger("setMonitor",d,{
11:1
});
break;

case 75:
e._trigger("setMonitor",d,{
34:1
});
break;

case 76:
e._trigger("setMonitor",d,{
35:1
});
}
e._trigger("sendMonitor",d),a.videoerror=t.code,e._g.dynamicErrMsg=t.err_msg||"",
a.duration_ms=0,r.vInfo.dynamicData=null,e._g.dataCount=e._g.targetDataCount,e.videoDataReady();
}
}):void o({
vid:t.vid,
ckey:t.ckey,
onSuc:function(t){
if(e._trigger("setMonitor",s,{
10:1,
11:1,
13:Math.min(t.c_time,6e4)
}),t.data.width&&t.data.height){
var i=Math.round(10*t.data.width/t.data.height*1);
i>20?i=20:0>i&&(i=0);
var o=41+2*i,n={};
n[o]=1,e._trigger("setMonitor",s,n);
}else e._trigger("setMonitor",s,{
83:1
});
e._trigger("sendMonitor",s),r.dataCount++,r.vInfo.dynamicData=t,a.getvinfo_ret=t.ret_code,
a.getvinfo_time=t.c_time,a.file_size=t.data.file_size,a.rate=t.data.rate,a.resolution=t.data.resolution,
a.format=t.data.format,a.vt=t.data.vt,a.video_ext=x.getsdtfrom(),e.videoDataReady();
},
onError:function(t,i){
if(e._trigger("setMonitor",s,{
10:1,
12:1,
13:Math.min(i.c_time,6e4)
}),-2==t)switch(1*i.ret_code){
case-2:
e._trigger("setMonitor",s,{
17:1
}),a.videoerror=2;
break;

case-3:
e._trigger("setMonitor",s,{
40:1
}),a.videoerror=53;
break;

case-4:
e._trigger("setMonitor",s,{
109:1
}),a.videoerror=54;
break;

case-5:
e._trigger("setMonitor",s,{
110:1
}),a.videoerror=55;
break;

case 61:
e._trigger("setMonitor",s,{
18:1
}),a.videoerror=25;
break;

case 62:
e._trigger("setMonitor",s,{
19:1
}),a.videoerror=26;
break;

case 64:
e._trigger("setMonitor",s,{
20:1
}),a.videoerror=27;
break;

case 67:
e._trigger("setMonitor",s,{
21:1
}),a.videoerror=28;
break;

case 69:
e._trigger("setMonitor",s,{
22:1
}),a.videoerror=52;
break;

case 80:
e._trigger("setMonitor",s,{
23:1
}),a.videoerror=29;
break;

case 81:
e._trigger("setMonitor",s,{
24:1
}),a.videoerror=50;
break;

case 85:
e._trigger("setMonitor",s,{
25:1
}),a.videoerror=51;
break;

default:
e._trigger("setMonitor",s,{
26:1
}),a.videoerror=24;
}else{
switch(1*t){
case-22:
e._trigger("setMonitor",s,{
15:1
});
break;

case-21:
e._trigger("setMonitor",s,{
14:1
});
break;

case-23:
e._trigger("setMonitor",s,{
16:1
});
}
a.videoerror=-1*t;
}
e._trigger("sendMonitor",s),e._g.dynamicErrMsg=i.err_msg||"",a.getvinfo_ret=i.ret_code,
a.duration_ms=0,a.getvinfo_time=i.c_time||0,r.vInfo.dynamicData=null,e._g.dataCount=e._g.targetDataCount,
e.videoDataReady();
}
});
},t.prototype._createPlayer=function(){
var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this,i=this._g,r=this._o,o=i.vInfo,n=this._report,a=o.dynamicData.data,s=[];
i.myAdPlugin&&s.push(i.myAdPlugin),i.noProxy!==!0&&A.isUseProxy&&s.push(new I({
vid:r.vid,
data:a,
cdn_url:a.totalUrl
})),n.duration_ms=parseInt(1e3*a.time),this._initPlayRangeInfo({
durationMs:n.duration_ms
}),n.vtitle=window.cgiData&&window.cgiData.video_title&&window.cgiData.video_title.htmlDecode()||a.title||"";
var d=!1,_=i.monitorUid,g=i.monitorUid2,c=t.getReportTypeBySceneType();
i.myPlayer=new z({
__biz:r.__biz,
mid:r.mid,
idx:r.idx,
videoTitle:n.vtitle,
videoReportType:c,
defineCSS:!0,
container:r.container,
cover:i.coverUrl,
ratio:r.ratio,
width:i.gWidth,
height:i.gHeight,
videoWidth:a.width,
videoHeight:a.height,
duration:a.time,
autoplay:r.autoplay,
isVideoSharePage:r.isVideoSharePage,
flow:a.flow,
loop:r.loop,
plugins:s,
src:a.totalUrl,
headImgUrl:r.headImgUrl,
jsapiFullScreen:r.jsapiFullScreen,
canShareVideo:r.canShareVideo,
pauseShowControll:r.pauseShowControll,
videoMd5:r.videoMd5,
extinfo:{
hit_bizuin:r.hit_bizuin,
hit_vid:r.hit_vid,
vid:r.vid,
preview:r.preview,
pageplayer:t
},
onLoaded:function(){
"function"==typeof e.onLoaded&&e.onLoaded();
},
onTimeupdate:function(e,o){
if(!d){
d=!0,C.report({
step:6,
vid:r.vid,
traceid:t._getTraceId(),
orderid:t._getOrderid(),
type:c,
fromid:t._o.fromid
});
var a=this.getLog(),s=a.loadwait||0;
t._qqVideoReport({
step:6,
loadwait:s
});
}
i.is_report_pv||(i.is_report_pv=!0,t._trigger("clearMonitor",_),t._trigger("clearMonitor",g),
t._o.is_mp_video?(t._trigger("setMonitor",g,{
12:1,
13:1
}),t._trigger("sendMonitor",g)):(t._trigger("setMonitor",_,{
0:1,
1:1
}),t._trigger("sendMonitor",_))),n.last_ms=parseInt(1e3*o.currentTime),n.video_play_time=parseInt(1e3*o.currentTime),
t._reportCurRangeInfo({
curTime:n.last_ms
});
},
onBeginPlay:function(){
var e=o.status,i=this;
e&&!e.isEnd&&1*e.playTime>0&&1*e.playTime<.99*a.time&&(i.play(e.playTime),e.playTime=0),
n.client_time_when_play=Math.round(+new Date/1e3),n.click_play_button=1,"string"==typeof r.container&&"#"==r.container.charAt(0)&&"number"==typeof r.__count__&&r.__hasReport===!1&&(0==r.__count__?(new Image).src="/mp/jsreport?key=103&content=video_test&r="+Math.random():1==r.__count__?(new Image).src="/mp/jsreport?key=104&content=video_test&r="+Math.random():r.__count__>=2&&((new Image).src="/mp/jsreport?key=105&content=video_test&r="+Math.random()),
r.__hasReport=!0),t._trigger("beginPlay");
},
onFullscreenchange:function(e,i){
t._trigger("fullscreenchange",i);
},
onAriaReplay:function(){
t._trigger("ariaReplay");
},
onStatusChange:function(e,i){
"loading"!==i.status||"seeked"!==i.subStatus&&"seeking"!==i.subStatus||t._initPlayRangeInfo({
durationMs:n.duration_ms
}),t._trigger("statusChange",i);
},
onAfterReplay:function(){
t._trigger("afterReplay");
},
onHandDragComplete:function(e,i){
t._trigger("handDragComplete",i);
},
onBarDragComplete:function(e,i){
t._trigger("barDragComplete",i);
},
onEnd:function(){
this.hideControllBar(),n.hasended=1,C.report({
step:7,
vid:r.vid,
ext1:1e3*a.time,
traceid:t._getTraceId(),
orderid:t._getOrderid(),
type:c,
fromid:t._o.fromid
}),t._debug("onend isend:"+this.isEnd()),t._trigger("hidePauseTips"),t._trigger("showEndContent"),
t._reportCurRangeInfo({
curTime:n.last_ms
}),t._initPlayRangeInfo({
durationMs:n.duration_ms
});
},
onError:function(e,r){
if(n.videoerror=!r||!r.errorcode||r.errorcode>5||r.errorcode<=0?46:r.errorcode+40,
A.isUseProxy&&!t._g.noProxy?A.isAndroid?t._trigger("setMonitor",g,{
30:1
}):A.isIOS&&t._trigger("setMonitor",g,{
32:1
}):A.isUseProxy&&t._g.noProxy&&!t._g.hasReportProxyError&&(t._g.hasReportProxyError=!0,
A.isAndroid?t._trigger("setMonitor",g,{
31:1
}):A.isIOS&&t._trigger("setMonitor",g,{
33:1
})),t._o.is_mp_video){
switch(i.is_report_pv||(i.is_report_pv=!0,t._trigger("setMonitor",g,{
12:1
})),t._trigger("setMonitor",g,{
14:1
}),1*r.errorcode){
case 1:
t._trigger("setMonitor",g,{
15:1
});
break;

case 2:
t._trigger("setMonitor",g,{
16:1
});
break;

case 3:
t._trigger("setMonitor",g,{
17:1
});
break;

case 4:
t._trigger("setMonitor",g,{
18:1
});
break;

case 5:
t._trigger("setMonitor",g,{
19:1
});
break;

case 6:
t._trigger("setMonitor",g,{
39:1
});
break;

default:
t._trigger("setMonitor",g,{
20:1
});
}
t._trigger("sendMonitor",g);
}else{
switch(i.is_report_pv||(i.is_report_pv=!0,t._trigger("setMonitor",_,{
0:1
})),t._trigger("setMonitor",_,{
2:1,
3:1
}),1*r.errorcode){
case 1:
t._trigger("setMonitor",_,{
4:1
});
break;

case 2:
t._trigger("setMonitor",_,{
5:1
});
break;

case 3:
t._trigger("setMonitor",_,{
6:1
});
break;

case 4:
t._trigger("setMonitor",_,{
7:1
});
break;

case 5:
t._trigger("setMonitor",_,{
8:1
});
break;

default:
t._trigger("setMonitor",_,{
9:1
});
}
t._trigger("sendMonitor",_),t._trigger("sendMonitor",g);
}
n.v_err_code=r.errorcode,t._showError(),t._qqVideoReport({
step:1999,
val:n.videoerror
}),t._initPlayRangeInfo({
durationMs:n.duration_ms
});
},
onFirstBufferingTime:function(e,i){
t._trigger("firstBufferingTime",i);
},
onPlayingBufferingTime:function(e,i){
t._trigger("playingBufferingTime",i);
},
onDurationchange:function(){},
onFlowNotice:function(e,i){
t._trigger("flowNotice",i);
},
onUserplay:function(){
t._trigger("userplay");
},
onUserpause:function(){
t._trigger("userpause",{
curTime:this.getCurTime()
}),n.pause_num=(n.pause_num||0)+1;
},
onAfterCheckVideoFit:function(e,i){
var r={
97:1
};
i.needToFit===!0&&(r[98]=1,r[100]=1,i.os.ios&&(r[103]=1),i.os.android&&(r[106]=1),
i.supportObjectFit===!0&&(r[101]=1,i.os.ios&&(r[104]=1),i.os.android&&(r[107]=1))),
t._trigger("setMonitor",_,r),t._trigger("sendMonitor",_);
}
}),this._pvReport(),this._trigger("playerReady"),r.__count__=0,r.__hasReport=!1,
"string"==typeof r.container&&"#"==r.container.charAt(0)&&document.getElementById(r.container.substr(1)).getElementsByClassName("js_video_play_controll")[0].addEventListener("click",function(){
r.__count__++;
});
},t.prototype.getReportTypeBySceneType=function(){
return 0==this._o.scene_type?1:1==this._o.scene_type||2==this._o.scene_type?2:4==this._o.scene_type?3:7==this._o.scene_type?4:0;
},t.prototype._getFromid=function(){
return this._o.fromid;
},t.prototype._bindResize=function(){
var e=this;
j.on(window,"resize",function(){
e._o.height&&e._o.width&&(e._g.isShowTx&&e._g.txPlayer?setTimeout(function(){
try{
var t=$(e._o.container),i=e._o.width/e._o.height,r=t.offset().width,o=Math.floor(r/i);
0!=r&&(e._g.gWidth=r,e._g.gHeight=o,t.css({
height:o+"px"
}),e._g.txPlayer.resize({
width:r,
height:o
}));
}catch(n){}
},0):setTimeout(function(){
var t=$(e._o.container),i=e._o.width/e._o.height,r=t.offset().width,o=Math.floor(r/i);
0!=r&&(e._g.gWidth=r,e._g.gHeight=o,e.setVideoCSS({
width:r+"px",
height:o+"px"
}),t.css({
height:o+"px"
}));
},0));
},!1);
},t.prototype._setBlockPlugin=function(e,t){
this._blockPlugin[e]=t;
},t.prototype._trigger=function(e){
var t=void 0,i=void 0,r=this.plugins,o=this._blockPlugin[e]||this._blockPlugin.all,n=0;
if(o&&"function"==typeof o.recv&&(t=o.recv.apply(o,arguments),"[object Object]"==Object.prototype.toString.call(t)?(n|=t.code,
i=t.data):n|=t,1&n))return i;
for(var a=0,s=r.length;s>a&&(t=r[a].recv.apply(r[a],arguments),"[object Object]"==Object.prototype.toString.call(t)?(n|=t.code,
i=t.data):n|=t,!(2&n));++a);
if(!(this._blockInnerHandler||4&n)){
var d=this["__"+e+"Handler"];
d&&(t=d.apply(this,arguments),"[object Object]"==Object.prototype.toString.call(t)&&(i=t.data));
}
return 8&n||this.__triggerOutside.apply(this,arguments),i;
},t.prototype.__triggerOutside=function(){
var e=this._o,t=arguments,i=t[0];
if(i){
i=i.substr(0,1).toUpperCase()+i.substr(1);
var r=e["on"+i];
"function"==typeof r&&r.apply(this,t);
}
},t.prototype.preLoadCover=function(){
var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this,i=this._o,r=null,o=null,n=null;
i.ratio==16/9?(r=85,o=86,n=87):(r=89,o=90,n=91);
var a=this._g.coverUrl,s=new window.Image;
s.onload=function(){
s.onload=null,s.onerror=null,s=null;
var i={};
i[r]=1,i[o]=1;
var n=t._g.monitorUid;
t._trigger("setMonitor",n,i),t._trigger("sendMonitor",n),e.callback();
},s.onerror=function(){
s.onload=null,s.onerror=null,s=null;
var o={};
o[r]=1,o[n]=1;
var a=t._g.monitorUid;
t._trigger("setMonitor",a,o),i.ratio==16/9||i.is_mp_video?(t._trigger("sendMonitor",a),
e.callback()):!function(){
var r=new window.Image;
r.onload=function(){
t._g.myPlayer&&t._g.myPlayer._setCover&&(t._g.coverUrl=this.src,t._g.myPlayer._setCover(this.src,{
"background-image":'url("'+this.src+'")'
})),r.onload=null,r.onerror=null,r=null,t._trigger("setMonitor",a,{
93:1,
94:1
}),t._trigger("sendMonitor",a),e.callback();
},r.onerror=function(){
r.onload=null,r.onerror=null,r=null,t._trigger("setMonitor",a,{
93:1,
95:1
}),t._trigger("sendMonitor",a),e.callback();
},r.src=d(i.vid,16/9,i.is_mp_video);
}();
},s.src=a;
},t.prototype._getCover=function(){
var e=this._o;
return d(e.vid,e.ratio,e.is_mp_video);
},t.prototype._cacheData=function(){
var e=this._g.myPlayer,t=this._g.vInfo;
e&&(t.status||(t.status={}),"function"==typeof e.isEnd&&(t.status.isEnd=e.isEnd()),
"function"==typeof e.getCurTime&&(t.status.playTime=e.getCurTime()),g(this._o.vid,this._g.vInfo));
},t.prototype._getCache=function(){
var e=_(this._o.vid);
if(e){
var t=this._g.vInfo;
t.status=e.status||null,t.dynamicData=e.dynamicData||null;
}
},t.prototype._clearCache=function(){
c(this._o.vid);
},t.prototype._qqVideoReport=function(e){
var t={
step:e.step,
loadwait:e.loadwait||0,
val:e.val||0,
vid:this._o.vid
};
6==e.step&&(t.vt=this._report.vt),x.qqvideo_common_report(t);
},t.prototype._pvReport=function(){
this._qqVideoReport({
step:3
});
},t.prototype._showError=function(e,t){
t=t||1;
var i=this,r=this._report.videoerror,o=p(this._o.container.replace(/^#/,""));
if(o){
e=e||U;
var n=!1;
e===U&&(n=!0),o.innerHTML=E.tmpl(V,{
errType:t,
msg:e,
errcode:r,
showBtn:n,
width:o.offsetWidth,
height:o.offsetHeight,
is_mp_video:this._o.is_mp_video
});
{
var a=$(o).find(".js_video_errormsg_btn");
$(o).find(".js_video_errormsg_loading"),$(o).find(".js_error_area");
}
j.tap(a[0],function(){
i._reInit();
});
}
},t.prototype._reInit=function(){
var e=p(this._o.container.replace(/^#/,""));
e.innerHTML="";
var t=!1,i=!1;
A.isUseProxy&&this._report.videoerror>=41&&this._report.videoerror<=46&&(t=!0,this._g.noProxy&&(i=!0)),
this._init({
noProxy:t,
hasReportProxyError:i,
hasInitPlugins:!0,
gWidth:this._g.gWidth,
gHeight:this._g.gHeight
});
},t.prototype.__showEndContentHandler=function(){
this._debug("resetVideo"),this._g.myPlayer.resetVideo();
},t.prototype._debug=function(){},t.prototype.__ariaReplayHandler=function(){
this.__replayHandler();
},t.prototype.__replayHandler=function(){
this._g.is_report_pv=!1,this._qqVideoReport({
step:3
}),this._report.replay=1,this._g.myPlayer.replay();
},t.prototype._getTraceId=function(){
var e=this._g.myAdPlugin;
return e?e.getTraceId():0;
},t.prototype._getOrderid=function(){
var e=this._g.myAdPlugin;
return e?e.getOrderid():0;
},t.prototype._getOriStatus=function(){
return this._o.ori_status;
},t.prototype._getPlayerReportData=function(){
var e=this._report,t=this._g.myPlayer,i=this._g.myAdPlugin;
t&&(e.quick_play=t.hasDrag()?1:0,e.full_screen=t.hasFullScreen()?1:0,e.drag_times=t.getDrag().join(":|:"),
e.play_time=this.getRealPlayTime()),i&&(e.ad_play_time=i.getAdPlaytime(),e.traceid=i.getTraceId(),
e.orderid=i.getOrderid()),e.webviewid=C.getWebviewid();
},t.prototype._cacheReportData=function(){
var e=this;
this._g.reportDataTimeoutId&&(clearTimeout(this._g.reportDataTimeoutId),this._g.reportDataTimeoutId=null),
!A.videoDataLs||this._g.hasReport||this._g.hasDestroy||(this._getPlayerReportData(),
A.videoDataLs.set(this._g.reportDataLsKey,this._report,+new Date+A.videoDataLsExpTime)),
A.neeedTimoutSaveReportData&&!this._g.hasDestroy&&(this._g.reportDataTimeoutId=window.setTimeout(function(){
e._cacheReportData();
},1e3));
},t.prototype.getVid=function(){
return this._o.vid;
},t.prototype.pause=function(){
this._g.myPlayer&&this._g.myPlayer.pause4outer();
},t.prototype.play=function(e){
this._g.myPlayer&&this._g.myPlayer.play4outer(e);
},t.prototype.getRealPlayTime=function(){
var e=0;
return this._g.myPlayer&&(e=Math.round(1e3*this._g.myPlayer.getPlayTotalTime())),
e;
},t.prototype.getCurrentTime=function(){
var e=0,t=this._g.myPlayer;
return this._g.myPlayer&&(e=t.getCurTime()),e;
},t.prototype.getVideoData=function(){
return this._g.vInfo&&this._g.vInfo.dynamicData&&this._g.vInfo.dynamicData.data?this._g.vInfo.dynamicData.data:null;
},t.prototype.getReportData=function(){
return this._report;
},t.prototype.mpVideoReport=function(e){
if(e=e||{},!this._g.hasReport&&!this._g.hasDestroy){
this._g.hasReport=!0;
var t=this._report;
0===t.videoerror?this.cacheData():this.clearCache(),A.videoDataLs&&A.videoDataLs.remove(this._g.reportDataLsKey),
this._getPlayerReportData(),A._debug&&console.log("report video data:"+JSON.stringify(t)),
x.videoreport({
data:t,
async:e.async
});
}
},t.prototype.extendMpReportData=function(e){
l(this._report,e);
},t.prototype.getMpReportData=function(){
return this._report;
},t.prototype.clearCache=function(){
this._clearCache();
},t.prototype.cacheData=function(){
this._cacheData();
},t.prototype.setWidth=function(e){
this._g.myPlayer.setWidth(e);
},t.prototype.setHeight=function(e){
this._g.myPlayer.setHeight(e);
},t.prototype.renderLike=function(){
var e=this._g.myPlayer;
e&&e.isEnd()&&this._trigger("showEndContent");
},t.prototype.setVideoCSS=function(e){
var t=this,i=this._g.myPlayer,r=this._g.myAdPlugin;
i&&(i.setVideoCSS(e),r&&r.setSize(e),setTimeout(function(){
t.renderLike();
},0));
var o=$(this._o.container).find(".js_error_box");
o&&o.length>0&&o.css(e);
},t.prototype.destroy=function(){
for(var e=0;e<A.videoInstance.length;e++)A.videoInstance[e]===this&&(A.videoInstance.splice(e,1),
e--);
this._g&&(this._g.event&&f.removeListener({
type:"afterRemoveLoading",
func:this._g.event.afterRemoveLoading
}),this._g.myPlayer&&this._g.myPlayer.destroy(),this._g.hasDestroy=!0);
};
var F=-1!=navigator.userAgent.indexOf("MicroMessenger")&&(w.isIOS||w.isAndroid||w.isWp);
return{
getHashByVid:s,
mpVideoPlayer:t,
getFormatTime:z._getFormatTime,
getCoverByVid:d,
getQQVideoStaticInfo:a
};
});